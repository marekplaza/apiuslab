{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Witaj w ApiusLAB ApiusLAB to aplikacja do przyjaznego wykonywania szkole\u0144 i prezentacji technologii sieciowych Arista Networks w oparciu o skontenryzowany obraz systemu operacyjengo EOS (cEOS) oraz narz\u0119dzie containerlab containerlab.dev . Przygotowali\u015bmy dla Ciebie kilka ciekawych LAB\u00f3w bazuj\u0105cych na rozwi\u0105zaniach Arista Networks, m.in. z zakresu: MLAG, L&S, EVPN i telemetria. \u017byczymy udanej przygody z kontenerami i technologiami sieciowymi. Jak korzysta\u0107? Aplikacja wyst\u0119puje w postacji kontenera do pobrania z oficjalnego publicznego Docker Hub'a: sudo docker pull marekplaza/apiuslab:latest klonujemy repozytorium git clone https://github.com/marekplaza/apiuslab.git , przechodzimy do katalogu cd apiuslab/ i uruchamiamy poleceniem: sudo docker run --rm -it --privileged --network host -v /var/run/docker.sock:/var/run/docker.sock -v /var/run/netns:/var/run/netns -v /etc/hosts:/etc/hosts --pid = \"host\" -v $( pwd ) : $( pwd ) -w $( pwd ) marekplaza/apiuslab:latest W wyniku czego powinni\u015bmy otrzyma\u0107 konsol\u0119 u\u0142atwiaj\u0105c\u0105 nasze labowanie: Status LAB 'a: +---+-------------------------------------------+-----------+----------+--------------+---------------------------------+------+---------+-------------------+--------------+ | # | Topo Path | Lab Name | Name | Container ID | Image | Kind | State | IPv4 Address | IPv6 Address | +---+-------------------------------------------+-----------+----------+--------------+---------------------------------+------+---------+-------------------+--------------+ | 1 | ../test/apiuslab/LAB1_MLAG/LAB1_MLAG.yaml | LAB1_MLAG | CLIENT-1 | 1832039eabec | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172.100.100.1/24 | N/A | | 2 | | | CLIENT-2 | 034fa3b9b8b0 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172.100.100.2/24 | N/A | | 3 | | | LEAF-1 | f8e12dbcd101 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172.100.100.12/24 | N/A | | 4 | | | LEAF-2 | f125f9195ef5 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172.100.100.13/24 | N/A | | 5 | | | LEAF-3 | bd17d7473194 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172.100.100.14/24 | N/A | | 6 | | | LEAF-4 | 7de176deb149 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172.100.100.15/24 | N/A | | 7 | | | SPINE-1 | 7cc0f23c2897 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172.100.100.10/24 | N/A | | 8 | | | SPINE-2 | 63077f4f0964 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172.100.100.11/24 | N/A | +---+-------------------------------------------+-----------+----------+--------------+---------------------------------+------+---------+-------------------+--------------+ ========== Menu G\u0142owne: Opcje wyboru ========== Wybierz LAB' a: 01 . MLAG 02 . Leaf & Spine 03 . VxLAN 04 . EVPN VxLAN L2 05 . EVPN VxLAN L3 06 . Telemetria gRPC 88 . Reset 99 . Wyj\u015bcie Co chcia\u0142by\u015b zrobi\u0107? Wi\u0119cej informacji: Arista Networks arista.com Apius Technologies apius.pl \ud83d\udc33 + \ud83e\uddea (c) 2022 Marek Plaza ;)","title":"Pocz\u0105tek"},{"location":"#witaj-w-apiuslab","text":"ApiusLAB to aplikacja do przyjaznego wykonywania szkole\u0144 i prezentacji technologii sieciowych Arista Networks w oparciu o skontenryzowany obraz systemu operacyjengo EOS (cEOS) oraz narz\u0119dzie containerlab containerlab.dev . Przygotowali\u015bmy dla Ciebie kilka ciekawych LAB\u00f3w bazuj\u0105cych na rozwi\u0105zaniach Arista Networks, m.in. z zakresu: MLAG, L&S, EVPN i telemetria. \u017byczymy udanej przygody z kontenerami i technologiami sieciowymi.","title":"Witaj w ApiusLAB"},{"location":"#jak-korzystac","text":"Aplikacja wyst\u0119puje w postacji kontenera do pobrania z oficjalnego publicznego Docker Hub'a: sudo docker pull marekplaza/apiuslab:latest klonujemy repozytorium git clone https://github.com/marekplaza/apiuslab.git , przechodzimy do katalogu cd apiuslab/ i uruchamiamy poleceniem: sudo docker run --rm -it --privileged --network host -v /var/run/docker.sock:/var/run/docker.sock -v /var/run/netns:/var/run/netns -v /etc/hosts:/etc/hosts --pid = \"host\" -v $( pwd ) : $( pwd ) -w $( pwd ) marekplaza/apiuslab:latest W wyniku czego powinni\u015bmy otrzyma\u0107 konsol\u0119 u\u0142atwiaj\u0105c\u0105 nasze labowanie: Status LAB 'a: +---+-------------------------------------------+-----------+----------+--------------+---------------------------------+------+---------+-------------------+--------------+ | # | Topo Path | Lab Name | Name | Container ID | Image | Kind | State | IPv4 Address | IPv6 Address | +---+-------------------------------------------+-----------+----------+--------------+---------------------------------+------+---------+-------------------+--------------+ | 1 | ../test/apiuslab/LAB1_MLAG/LAB1_MLAG.yaml | LAB1_MLAG | CLIENT-1 | 1832039eabec | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172.100.100.1/24 | N/A | | 2 | | | CLIENT-2 | 034fa3b9b8b0 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172.100.100.2/24 | N/A | | 3 | | | LEAF-1 | f8e12dbcd101 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172.100.100.12/24 | N/A | | 4 | | | LEAF-2 | f125f9195ef5 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172.100.100.13/24 | N/A | | 5 | | | LEAF-3 | bd17d7473194 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172.100.100.14/24 | N/A | | 6 | | | LEAF-4 | 7de176deb149 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172.100.100.15/24 | N/A | | 7 | | | SPINE-1 | 7cc0f23c2897 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172.100.100.10/24 | N/A | | 8 | | | SPINE-2 | 63077f4f0964 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172.100.100.11/24 | N/A | +---+-------------------------------------------+-----------+----------+--------------+---------------------------------+------+---------+-------------------+--------------+ ========== Menu G\u0142owne: Opcje wyboru ========== Wybierz LAB' a: 01 . MLAG 02 . Leaf & Spine 03 . VxLAN 04 . EVPN VxLAN L2 05 . EVPN VxLAN L3 06 . Telemetria gRPC 88 . Reset 99 . Wyj\u015bcie Co chcia\u0142by\u015b zrobi\u0107?","title":"Jak korzysta\u0107?"},{"location":"#wiecej-informacji","text":"Arista Networks arista.com Apius Technologies apius.pl \ud83d\udc33 + \ud83e\uddea (c) 2022 Marek Plaza ;)","title":"Wi\u0119cej informacji:"},{"location":"about%20copy/","text":"o ApiusLAB ApiusLAB jest prost\u0105 skonteneryzowan\u0105 aplikacj\u0105 umozli test dodawania notatek Notatka Szeroki wyb\u00f3r technik i rozwi\u0105za\u0144 z zakresu bezpiecze\u0144stwa informacji w ofercie APIUS umo\u017cliwi Pa\u0144stwu stworzenie skutecznego systemu odpowiedzi na istniej\u0105ce i nowe zagro\u017cenia. Animowany GIF align to center","title":"About copy"},{"location":"about%20copy/#o-apiuslab","text":"ApiusLAB jest prost\u0105 skonteneryzowan\u0105 aplikacj\u0105 umozli","title":"o ApiusLAB"},{"location":"about%20copy/#test-dodawania-notatek","text":"Notatka Szeroki wyb\u00f3r technik i rozwi\u0105za\u0144 z zakresu bezpiecze\u0144stwa informacji w ofercie APIUS umo\u017cliwi Pa\u0144stwu stworzenie skutecznego systemu odpowiedzi na istniej\u0105ce i nowe zagro\u017cenia.","title":"test dodawania notatek"},{"location":"about%20copy/#animowany-gif","text":"align to center","title":"Animowany GIF"},{"location":"about/","text":"o ApiusLAB ApiusLAB jest prost\u0105 skonteneryzowan\u0105 aplikacj\u0105 umozli test dodawania notatek Notatka Szeroki wyb\u00f3r technik i rozwi\u0105za\u0144 z zakresu bezpiecze\u0144stwa informacji w ofercie APIUS umo\u017cliwi Pa\u0144stwu stworzenie skutecznego systemu odpowiedzi na istniej\u0105ce i nowe zagro\u017cenia.","title":"About"},{"location":"about/#o-apiuslab","text":"ApiusLAB jest prost\u0105 skonteneryzowan\u0105 aplikacj\u0105 umozli","title":"o ApiusLAB"},{"location":"about/#test-dodawania-notatek","text":"Notatka Szeroki wyb\u00f3r technik i rozwi\u0105za\u0144 z zakresu bezpiecze\u0144stwa informacji w ofercie APIUS umo\u017cliwi Pa\u0144stwu stworzenie skutecznego systemu odpowiedzi na istniej\u0105ce i nowe zagro\u017cenia.","title":"test dodawania notatek"},{"location":"index%20copy/","text":"Witaj w Arista Labs by Apius Info strona w trakcie tworzenia ;) Wi\u0119cej informacji o Arista Networks arista.com Wi\u0119cej informacji o Apius Technologies apius.pl Wprowadzenie \ud83d\udc33 + \ud83e\uddea Wszystkie przyk\u0142ady na tej stronie mo\u017cesz wykona\u0107 w oparciu o skontenryzowany obraz systemu operacyjengo EOS oraz narz\u0119dzie containerlab containerlab.dev . Znajdziesz tutaj dokumentacje do warsztat\u00f3w traktuj\u0105cych o techologiach sieciowych Popularne komendy enable - Przej\u015bcie do trypu uprzywilejowanego. config - wybranie trybu wprowadzania zmian konfiguracji. show clock - Wy\u015bwietla aktualny czas na urz\u0105dzeniu. write memory - Zapisanie zmian w konfiguracji. Lab przyk\u0142ad konfiguracji Laby uruchamiane s\u0105 w oparciu o narz\u0119dzie containerlab-based . link topo.yaml describing the topology looks like follows: topo.yaml name : test mgmt : bridge : OoB network : OoB_network ipv4_subnet : 172.20.20.0/24 ipv4-gw : 172.20.20.1 topology : kinds : ceos : image : ceos64-lab:4.27.1.1F startup-config : vrf-mgmt.cfg nodes : sw1-cfg : kind : ceos sw2-cfg : kind : ceos links : - endpoints : [ \"sw1-cfg:eth1\" , \"sw2-cfg:eth1\" ] - endpoints : [ \"sw1-cfg:eth2\" , \"sw2-cfg:eth2\" ] kod z adnotacj\u0105 (z emoji) + pod\u015bwietlenie wybranych lini kodu abc.cfg topology : kinds : ceos : image : ceos64-lab:4.27.1.1F # (1) Wybierz najnowsz\u0105 wersj\u0119 cEOS! przyk\u0142ad tabeli TBD przyk\u0142ad osadzenia obrazka z Draw.io jako HTML ...(a nawet wprost linku do pliku *.io ) : containerlab","title":"Witaj w Arista Labs by Apius"},{"location":"index%20copy/#witaj-w-arista-labs-by-apius","text":"Info strona w trakcie tworzenia ;) Wi\u0119cej informacji o Arista Networks arista.com Wi\u0119cej informacji o Apius Technologies apius.pl","title":"Witaj w Arista Labs by Apius"},{"location":"index%20copy/#wprowadzenie","text":"\ud83d\udc33 + \ud83e\uddea Wszystkie przyk\u0142ady na tej stronie mo\u017cesz wykona\u0107 w oparciu o skontenryzowany obraz systemu operacyjengo EOS oraz narz\u0119dzie containerlab containerlab.dev . Znajdziesz tutaj dokumentacje do warsztat\u00f3w traktuj\u0105cych o techologiach sieciowych","title":"Wprowadzenie"},{"location":"index%20copy/#popularne-komendy","text":"enable - Przej\u015bcie do trypu uprzywilejowanego. config - wybranie trybu wprowadzania zmian konfiguracji. show clock - Wy\u015bwietla aktualny czas na urz\u0105dzeniu. write memory - Zapisanie zmian w konfiguracji.","title":"Popularne komendy"},{"location":"index%20copy/#lab-przykad-konfiguracji","text":"Laby uruchamiane s\u0105 w oparciu o narz\u0119dzie containerlab-based . link topo.yaml describing the topology looks like follows: topo.yaml name : test mgmt : bridge : OoB network : OoB_network ipv4_subnet : 172.20.20.0/24 ipv4-gw : 172.20.20.1 topology : kinds : ceos : image : ceos64-lab:4.27.1.1F startup-config : vrf-mgmt.cfg nodes : sw1-cfg : kind : ceos sw2-cfg : kind : ceos links : - endpoints : [ \"sw1-cfg:eth1\" , \"sw2-cfg:eth1\" ] - endpoints : [ \"sw1-cfg:eth2\" , \"sw2-cfg:eth2\" ]","title":"Lab przyk\u0142ad konfiguracji"},{"location":"index%20copy/#kod-z-adnotacja-z-emoji-podswietlenie-wybranych-lini-kodu","text":"abc.cfg topology : kinds : ceos : image : ceos64-lab:4.27.1.1F # (1) Wybierz najnowsz\u0105 wersj\u0119 cEOS!","title":"kod z adnotacj\u0105 (z emoji) + pod\u015bwietlenie wybranych lini kodu"},{"location":"index%20copy/#przykad-tabeli","text":"TBD","title":"przyk\u0142ad tabeli"},{"location":"index%20copy/#przykad-osadzenia-obrazka-z-drawio-jako-html","text":"...(a nawet wprost linku do pliku *.io ) : containerlab","title":"przyk\u0142ad osadzenia obrazka z Draw.io jako HTML"},{"location":"kb/hw/","text":"Aktualne portfolio model ports chipset buffers docs Arista DCS-7100 Arista DCS-7124S 24 SFP+ Intel FM4224 4MB Datasheet Arista DCS-7148S 48 SFP+ Intel FM4224 8MB Datasheet Arista DCS-7124FX 24 SFP+ Intel FM4224 4MB Datasheet Arista DCS-7124SX 24 SFP+ Intel FM4224 4MB Datasheet Arista DCS-7148SX 48 SFP+ Intel FM4224 8MB Datasheet Arista DCS-7150S Arista DCS-7150S-24 24 SFP+ Intel FM6000 7.5MB Datasheet Arista DCS-7150S-52 52 SFP+ Intel FM6000 7.5MB Datasheet Arista DCS-7150S-64 48 SFP+ and 4 QSFP+ Intel FM6000 7.5MB Datasheet Arista DCS-7050S Arista DCS-7050S-64 48 SFP+ and 4 QSFP+ Trident+ 9MB Datasheet Arista DCS-7050S-52 52 SFP+ Trident+ 9MB Datasheet Arista DCS-7050Q-16 16 QSFP+ and 8 SFP+ Trident+ 9MB Datasheet Arista DCS-7050T Arista DCS-7050T-36 32 10G BASE-T and 4 SFP+ Trident+ 9MB Datasheet Arista DCS-7050T-52 48 10G BASE-T and 4 SFP+ Trident+ 9MB Datasheet Arista DCS-7050T-64 48 10G BASE-T and 4 QSFP+ Trident+ 9MB Datasheet Arista DCS-7050TX Arista 7050TX-48 32 10G BASE-T and 4 QSFP+ Trident2 12MB Datasheet Arista 7050TX-64 48 10G BASE-T and 4 QSFP+ Trident2 12MB Datasheet Arista 7050TX-72Q 48 10G BASE-T and 6 QSFP+ Trident2 12MB Datasheet Arista 7050TX-96 48 10G BASE-T and 4 MXP Trident2 12MB Datasheet Arista 7050TX-128 96 10G BASE-T and 8 QSFP+ Trident2 12MB Datasheet Arista DCS-7050SX Arista DCS-7050SX-64 48 SFP+ and 4 QSFP+ Trident2 12MB Datasheet Arista DCS-7050SX-72 48 SFP+ and 2 MXP Trident2 12MB Datasheet Arista DCS-7050SX-72Q 48 SFP+ and 6 QSFP+ Trident2 12MB Datasheet Arista DCS-7050SX-96 48 SFP+ and 4 MXP Trident2 12MB Datasheet Arista DCS-7050SX-128 96 SFP+ and 8 QSFP+ Trident2 12MB Datasheet Arista DCS-7050QX Arista DCS-7050QX-32 32 QSFP+ Trident2 12MB Datasheet Arista DCS-7050QX-32S 32 QSFP+ and 4 SFP+ Trident2 12MB Datasheet Arista DCS-7050TX2 Arista 7050TX2-128 96 10G BASE-T and 8 QSFP+ Trident2+ 16MB Datasheet Arista DCS-7050SX2 Arista 7050SX2-72Q 48 SFP+ and 6 QSFP+ Trident2+ 16MB Datasheet Arista 7050SX2-128 96 SFP+ and 8 QSFP+ Trident2+ 16MB Datasheet Arista DCS-7050QX2 Arista DCS-7050QX2-32S 32 QSFP+ and 4 SFP+ Trident2+ 16MB Datasheet Arista DCS-7050TX3 Arista DCS-7050TX3-48C8 48 10G BASE-T and 8 QSFP28 Trident3 32MB Datasheet Arista DCS-7050SX3 Arista DCS-7050SX3-48YC8 48 SFP28 and 8 QSFP28 Trident 3 32MB Datasheet Arista DCS-7050SX3-48YC12 48 SFP28 and 12 QSFP28 Trident 3 32MB Datasheet Arista DCS-7050SX3-48C8 48 SFP+ and 10 QSFP28 Trident 3 32MB Datasheet Arista DCS-7050CX3 Arista DCS-7050CX3-32S 32 QSFP28 and 2 SFP+ Trident 3 32MB Datasheet Arista DCS-7050CX3M-32S (MACSEC) 32 QSFP28 and 2 SFP+ Trident 3 32MB Datasheet Arista DCS-7060QX Arista DCS-7260QX-64 64 QSFP+ and 2 SFP+ Tomahawk 16MB Datasheet Arista DCS-7060CX Arista DCS-7060CX-32S 32 QSFP28 and 2 SFP+ Tomahawk 16MB Datasheet Arista DCS-7260CX-64 64 QSFP28 and 2 SFP+ Tomahawk 64MB Datasheet Arista DCS-7060CX2 Arista DCS-7060CX2-32S 32 QSFP28 and 2 SFP+ Tomahawk+ 22MB Datasheet Arista DCS-7060SX2 Arista DCS-7060SX2-48YC6 48 SFP28 and 6 QSFP28 Tomahawk+ 22MB Datasheet Arista DCS-7060DX4 Arista DCS-7060DX4-32 32 400G QSFP-DD Tomahawk 3 64MB Datasheet Arista DCS-7060PX4 Arista DCS-7060PX4-32 32 400G OSFP Tomahawk 3 64MB Datasheet Arista DCS-7160 Arista DCS-7160-32CQ 32 QSFP28 and 4 SFP+ Cavium XP80 24MB Datasheet Arista DCS-7160-48YC6 48SFP28 and 6 QSFP28 Cavium XP80 24MB Datasheet Arista DCS-7160-48TC6 48 10G BASE-T and 6 QSFP28 Cavium XP80 24MB Datasheet Arista DCS-7170 Arista DCS-7170-32C 32 QSFP28 and 2 SFP+ Barefoot Tofino 22MB Datasheet Arista DCS-7170-32CD 32 QSFP28 and 2 SFP+ Barefoot Tofino 22MB Datasheet Arista DCS-7170-64C 64 QSFP28 and 2 SFP+ Barefoot Tofino 22MB Datasheet Arista DCS-7280SE Arista DCS-7280SE-64 48 SFP+ and 4 QSFP+ Arad 9GB Datasheet Arista DCS-7280SE-68 48 SFP+ and 2 QSFP28 Arad 9GB Datasheet Arista DCS-7280SE-72 48 SFP+ and 2 MXP Arad 9GB Datasheet Arista DCS-7280R Arista DCS-7280CR-48 48 QSFP28 and 8 QSFP+ Jericho 32GB Datasheet Arista DCS-7280QR-C72 56 QSFP+ and 16 QSFP28 Jericho 16GB Datasheet Arista DCS-7280QR-C36 24 QSFP+ and 12 QSFP28 Jericho 8GB Datasheet Arista DCS-7280SR-48C6 48 SFP+ and 6 QSFP28 Jericho 4GB Datasheet Arista DCS-7280TR-48C6 48 10G BASE-T and 6 QSFP28 Jericho 4GB Datasheet Arista DCS-7280RA Arista DCS-7280QRA-C36S 24 QSFP+ and 12 QSFP28 Jericho 8GB Datasheet Arista DCS-7280SRA-48C6 48 SFP+ and 6 QSFP28 Jericho 4GB Datasheet Arista DCS-7280TRA-48C6 48 10G BASE-T and 6 QSFP28 Jericho 4GB Datasheet Arista DCS-7280R2 Arista DCS-7280SR2-48YC6 48 SFP28 and 6 QSFP28 Jericho+ 8GB Datasheet Arista DCS-7280CR2-60 60 QSFP28 Jericho+ 24GB Datasheet Arista DCS-7280R2A Arista DCS-7280SR2A-48YC6 48 SFP28 and 6 QSFP28 Jericho+ 8GB Datasheet Arista DCS-7280CR2A-60 60 QSFP28 Jericho+ 24GB Datasheet Arista DCS-7280CR2A-30 30 QSFP28 Jericho+ 12GB Datasheet Arista DCS-7280R2K Arista DCS-7280SR2K-48C6 24 10SFP+ 24 SFP28 and 6 QSFP28 Jericho+ 4GB Datasheet Arista DCS-7280CR2K-60 60 QSFP28 Jericho+ 24GB Datasheet Arista DCS-7280CR2K-30 30 QSFP28 Jericho+ 12GB Datasheet Arista DCS-7280R3 Arista DCS-7280PR3-24 24 OSFP/QSFP-DD Jericho2 16GB Datasheet Arista DCS-7280DR3-24 24 QSFP-DD Jericho2 16GB Datasheet Arista DCS-7280CR3-32P4 32 QFP28 and 4 OSFP Jericho2 8GB Datasheet Arista DCS-7280CR3-32D4 32 QFP28 and 4 QSFP-DD Jericho2 8GB Datasheet Arista DCS-7280CR3-96 96 QSFP28 Jericho2 16GB Datasheet Arista DCS-7280R3K Arista DCS-7280PR3K-24 24 OSFP/QSFP-DD Jericho2 16GB Datasheet Arista DCS-7280DR3K-24 24 QSFP-DD Jericho2 16GB Datasheet Arista DCS-7280CR3K-32P4 32 QFP28 and 4 OSFP Jericho2 8GB Datasheet Arista DCS-7280CR3K-32D4 32 QFP28 and 4 QSFP-DD Jericho2 8GB Datasheet Arista DCS-7280CR3K-96 96 QSFP28 Jericho2 16GB Datasheet Arista DCS-7280R3M Arista DCS-7280CR3MK-32P4S 32 QFP28 and 4 OSFP Jericho2 8GB Datasheet Arista DCS-7280CR3MK-32D4S 32 QFP28 and 4 QSFP-DD Jericho2 8GB Datasheet Arista DCS-7280SR3M-48YC8 48 SFP28 and 6 QSFP28 Jericho2 4GB Datasheet Arista Modular chassis Arista 7300X Arista 7500 Line cards all generations","title":"Portfolio"},{"location":"kb/hw/#aktualne-portfolio","text":"model ports chipset buffers docs Arista DCS-7100 Arista DCS-7124S 24 SFP+ Intel FM4224 4MB Datasheet Arista DCS-7148S 48 SFP+ Intel FM4224 8MB Datasheet Arista DCS-7124FX 24 SFP+ Intel FM4224 4MB Datasheet Arista DCS-7124SX 24 SFP+ Intel FM4224 4MB Datasheet Arista DCS-7148SX 48 SFP+ Intel FM4224 8MB Datasheet Arista DCS-7150S Arista DCS-7150S-24 24 SFP+ Intel FM6000 7.5MB Datasheet Arista DCS-7150S-52 52 SFP+ Intel FM6000 7.5MB Datasheet Arista DCS-7150S-64 48 SFP+ and 4 QSFP+ Intel FM6000 7.5MB Datasheet Arista DCS-7050S Arista DCS-7050S-64 48 SFP+ and 4 QSFP+ Trident+ 9MB Datasheet Arista DCS-7050S-52 52 SFP+ Trident+ 9MB Datasheet Arista DCS-7050Q-16 16 QSFP+ and 8 SFP+ Trident+ 9MB Datasheet Arista DCS-7050T Arista DCS-7050T-36 32 10G BASE-T and 4 SFP+ Trident+ 9MB Datasheet Arista DCS-7050T-52 48 10G BASE-T and 4 SFP+ Trident+ 9MB Datasheet Arista DCS-7050T-64 48 10G BASE-T and 4 QSFP+ Trident+ 9MB Datasheet Arista DCS-7050TX Arista 7050TX-48 32 10G BASE-T and 4 QSFP+ Trident2 12MB Datasheet Arista 7050TX-64 48 10G BASE-T and 4 QSFP+ Trident2 12MB Datasheet Arista 7050TX-72Q 48 10G BASE-T and 6 QSFP+ Trident2 12MB Datasheet Arista 7050TX-96 48 10G BASE-T and 4 MXP Trident2 12MB Datasheet Arista 7050TX-128 96 10G BASE-T and 8 QSFP+ Trident2 12MB Datasheet Arista DCS-7050SX Arista DCS-7050SX-64 48 SFP+ and 4 QSFP+ Trident2 12MB Datasheet Arista DCS-7050SX-72 48 SFP+ and 2 MXP Trident2 12MB Datasheet Arista DCS-7050SX-72Q 48 SFP+ and 6 QSFP+ Trident2 12MB Datasheet Arista DCS-7050SX-96 48 SFP+ and 4 MXP Trident2 12MB Datasheet Arista DCS-7050SX-128 96 SFP+ and 8 QSFP+ Trident2 12MB Datasheet Arista DCS-7050QX Arista DCS-7050QX-32 32 QSFP+ Trident2 12MB Datasheet Arista DCS-7050QX-32S 32 QSFP+ and 4 SFP+ Trident2 12MB Datasheet Arista DCS-7050TX2 Arista 7050TX2-128 96 10G BASE-T and 8 QSFP+ Trident2+ 16MB Datasheet Arista DCS-7050SX2 Arista 7050SX2-72Q 48 SFP+ and 6 QSFP+ Trident2+ 16MB Datasheet Arista 7050SX2-128 96 SFP+ and 8 QSFP+ Trident2+ 16MB Datasheet Arista DCS-7050QX2 Arista DCS-7050QX2-32S 32 QSFP+ and 4 SFP+ Trident2+ 16MB Datasheet Arista DCS-7050TX3 Arista DCS-7050TX3-48C8 48 10G BASE-T and 8 QSFP28 Trident3 32MB Datasheet Arista DCS-7050SX3 Arista DCS-7050SX3-48YC8 48 SFP28 and 8 QSFP28 Trident 3 32MB Datasheet Arista DCS-7050SX3-48YC12 48 SFP28 and 12 QSFP28 Trident 3 32MB Datasheet Arista DCS-7050SX3-48C8 48 SFP+ and 10 QSFP28 Trident 3 32MB Datasheet Arista DCS-7050CX3 Arista DCS-7050CX3-32S 32 QSFP28 and 2 SFP+ Trident 3 32MB Datasheet Arista DCS-7050CX3M-32S (MACSEC) 32 QSFP28 and 2 SFP+ Trident 3 32MB Datasheet Arista DCS-7060QX Arista DCS-7260QX-64 64 QSFP+ and 2 SFP+ Tomahawk 16MB Datasheet Arista DCS-7060CX Arista DCS-7060CX-32S 32 QSFP28 and 2 SFP+ Tomahawk 16MB Datasheet Arista DCS-7260CX-64 64 QSFP28 and 2 SFP+ Tomahawk 64MB Datasheet Arista DCS-7060CX2 Arista DCS-7060CX2-32S 32 QSFP28 and 2 SFP+ Tomahawk+ 22MB Datasheet Arista DCS-7060SX2 Arista DCS-7060SX2-48YC6 48 SFP28 and 6 QSFP28 Tomahawk+ 22MB Datasheet Arista DCS-7060DX4 Arista DCS-7060DX4-32 32 400G QSFP-DD Tomahawk 3 64MB Datasheet Arista DCS-7060PX4 Arista DCS-7060PX4-32 32 400G OSFP Tomahawk 3 64MB Datasheet Arista DCS-7160 Arista DCS-7160-32CQ 32 QSFP28 and 4 SFP+ Cavium XP80 24MB Datasheet Arista DCS-7160-48YC6 48SFP28 and 6 QSFP28 Cavium XP80 24MB Datasheet Arista DCS-7160-48TC6 48 10G BASE-T and 6 QSFP28 Cavium XP80 24MB Datasheet Arista DCS-7170 Arista DCS-7170-32C 32 QSFP28 and 2 SFP+ Barefoot Tofino 22MB Datasheet Arista DCS-7170-32CD 32 QSFP28 and 2 SFP+ Barefoot Tofino 22MB Datasheet Arista DCS-7170-64C 64 QSFP28 and 2 SFP+ Barefoot Tofino 22MB Datasheet Arista DCS-7280SE Arista DCS-7280SE-64 48 SFP+ and 4 QSFP+ Arad 9GB Datasheet Arista DCS-7280SE-68 48 SFP+ and 2 QSFP28 Arad 9GB Datasheet Arista DCS-7280SE-72 48 SFP+ and 2 MXP Arad 9GB Datasheet Arista DCS-7280R Arista DCS-7280CR-48 48 QSFP28 and 8 QSFP+ Jericho 32GB Datasheet Arista DCS-7280QR-C72 56 QSFP+ and 16 QSFP28 Jericho 16GB Datasheet Arista DCS-7280QR-C36 24 QSFP+ and 12 QSFP28 Jericho 8GB Datasheet Arista DCS-7280SR-48C6 48 SFP+ and 6 QSFP28 Jericho 4GB Datasheet Arista DCS-7280TR-48C6 48 10G BASE-T and 6 QSFP28 Jericho 4GB Datasheet Arista DCS-7280RA Arista DCS-7280QRA-C36S 24 QSFP+ and 12 QSFP28 Jericho 8GB Datasheet Arista DCS-7280SRA-48C6 48 SFP+ and 6 QSFP28 Jericho 4GB Datasheet Arista DCS-7280TRA-48C6 48 10G BASE-T and 6 QSFP28 Jericho 4GB Datasheet Arista DCS-7280R2 Arista DCS-7280SR2-48YC6 48 SFP28 and 6 QSFP28 Jericho+ 8GB Datasheet Arista DCS-7280CR2-60 60 QSFP28 Jericho+ 24GB Datasheet Arista DCS-7280R2A Arista DCS-7280SR2A-48YC6 48 SFP28 and 6 QSFP28 Jericho+ 8GB Datasheet Arista DCS-7280CR2A-60 60 QSFP28 Jericho+ 24GB Datasheet Arista DCS-7280CR2A-30 30 QSFP28 Jericho+ 12GB Datasheet Arista DCS-7280R2K Arista DCS-7280SR2K-48C6 24 10SFP+ 24 SFP28 and 6 QSFP28 Jericho+ 4GB Datasheet Arista DCS-7280CR2K-60 60 QSFP28 Jericho+ 24GB Datasheet Arista DCS-7280CR2K-30 30 QSFP28 Jericho+ 12GB Datasheet Arista DCS-7280R3 Arista DCS-7280PR3-24 24 OSFP/QSFP-DD Jericho2 16GB Datasheet Arista DCS-7280DR3-24 24 QSFP-DD Jericho2 16GB Datasheet Arista DCS-7280CR3-32P4 32 QFP28 and 4 OSFP Jericho2 8GB Datasheet Arista DCS-7280CR3-32D4 32 QFP28 and 4 QSFP-DD Jericho2 8GB Datasheet Arista DCS-7280CR3-96 96 QSFP28 Jericho2 16GB Datasheet Arista DCS-7280R3K Arista DCS-7280PR3K-24 24 OSFP/QSFP-DD Jericho2 16GB Datasheet Arista DCS-7280DR3K-24 24 QSFP-DD Jericho2 16GB Datasheet Arista DCS-7280CR3K-32P4 32 QFP28 and 4 OSFP Jericho2 8GB Datasheet Arista DCS-7280CR3K-32D4 32 QFP28 and 4 QSFP-DD Jericho2 8GB Datasheet Arista DCS-7280CR3K-96 96 QSFP28 Jericho2 16GB Datasheet Arista DCS-7280R3M Arista DCS-7280CR3MK-32P4S 32 QFP28 and 4 OSFP Jericho2 8GB Datasheet Arista DCS-7280CR3MK-32D4S 32 QFP28 and 4 QSFP-DD Jericho2 8GB Datasheet Arista DCS-7280SR3M-48YC8 48 SFP28 and 6 QSFP28 Jericho2 4GB Datasheet Arista Modular chassis Arista 7300X Arista 7500 Line cards all generations","title":"Aktualne portfolio"},{"location":"kb/tt/","text":"","title":"Tt"},{"location":"labs/lab1%20copy/","text":"Wst\u0119p Celem \u0107wiczenia jest skonfigurowanie interfejs\u00f3w zaagregowanych Po oraz sekcji mlag na prze\u0142\u0105czniku LEAF-4 tworz\u0105cego z prze\u0142\u0105cznikiem LEAF-3 par\u0119 pracuj\u0105c\u0105 w technologii MLAG 1 . Minimalne wymagania sprz\u0119towo do samodzielnego uruchomienia \u015brodowiska: Topologia LAB1-MLAG core Elementy LAB1 6 cEOS & 0 Linux nodes Wymagane zasoby sprz\u0119towe 4vCPU 16 GB Topologia LAB1_MLAG.yaml Dokumentacja Producenta \u00b7 MLAG guide \u00b7 cEOS guide Informacja o wersjach 2 apiusLAB , ceos64-lab:4.27.1.1F Schemat po\u0142\u0105cze\u0144 / topologia fizyczna Topologi\u0119 fizyczn\u0105, organziacj\u0119 po\u0142\u0105cze\u0144 w naszej sieci przedstawia rysunek: containerlab-MLAG-physical Uruchamianie LAB1_MLAG (apiusLAB) Uruchamiamy nasze laboratorium wybieraj\u0105c z MENU konsoli ApiusLAB \u0107wiczenie: 01 MLAG, a nast\u0119pnie w podmenu ponownie: 01 - uruchom LABa'a. Menu G\u0142owne -> Wybierz LAB'a -> LAB1_MLAG ========== Menu G\u0142owne: Opcje wyboru ========== Wybierz LAB ' a: 01 . MLAG 02 . Leaf & Spine 03 . VxLAN 04 . EVPN VxLAN L2 05 . EVPN VxLAN L3 06 . Telemetria gRPC 88 . Reset 99 . Wyj\u015bcie Co chcia\u0142by\u015b zrobi\u0107? W rezultacie po kilku minutach zostanie uruchomione \u015brodowisko: powo\u0142ane zostan\u0105 kontenery cEOS oraz utworzone po\u0142\u0105czenia sieciowe przy pomocy narz\u0119dzia containerlab zgodnie z zadan\u0105 topologi\u0105 opisan\u0105 deklaratywnie w pliku YAML: LAB1_MLAG.yaml : Stauts LAB'a ' +---+--------------------------+-----------+----------+--------------+---------------------------------+------+---------+-------------------+--------------+ | # | Topo Path | Lab Name | Name | Container ID | Image | Kind | State | IPv4 Address | IPv6 Address | +---+--------------------------+-----------+----------+--------------+---------------------------------+------+---------+-------------------+--------------+ | 1 | LAB1_MLAG/LAB1_MLAG.yaml | LAB1_MLAG | CLIENT-1 | 1832039eabec | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.1/24 | N/A | | 2 | | | CLIENT-2 | 034fa3b9b8b0 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.2/24 | N/A | | 3 | | | LEAF-1 | f8e12dbcd101 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.12/24 | N/A | | 4 | | | LEAF-2 | f125f9195ef5 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.13/24 | N/A | | 5 | | | LEAF-3 | bd17d7473194 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.14/24 | N/A | | 6 | | | LEAF-4 | 7de176deb149 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.15/24 | N/A | | 7 | | | SPINE-1 | 7cc0f23c2897 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.10/24 | N/A | | 8 | | | SPINE-2 | 63077f4f0964 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.11/24 | N/A | +---+--------------------------+-----------+----------+--------------+---------------------------------+------+---------+-------------------+--------------+ W naszym przypadku wygodniejszym sposobem b\u0119dzie skorzytanie z ApiusLAB i wyb\u00f3r opcji: 04 \"Screen do wszystkich router\u00f3w: Menu G\u0142owne -> Wybierz LAB'a -> LAB1_MLAG ========== Menu G\u0142owne -> Wybierz LAB ' a -> LAB1_MLAG ========== 02 . Restartuj LAB 03 . Wy\u0142\u0105cz LAB 04 . Screen do wszystkich router\u00f3w 05 . Shell/Bash 99 . Powr\u00f3t Co chcia\u0142by\u015b zrobi\u0107? W oddzielnych zak\u0142adkach uzyskujemy dost\u0119p do CLI uruchomionych \"urz\u0105dze\u0144\". Nawigacja w screen Wazniejsze skr\u00f3ty klawiszowe do pracy z screen: ctrl+a n - Przej\u015bcie do nast\u0119pnej zak\u0142adki. ctrl+a p - Przej\u015bcie do poprzedniej zak\u0142adki ctrl+a d - Zamkni\u0119cie wszystkich zak\u0142adek, przej\u015bcie do poprzedniego MENU Info Do ka\u017cdego z kontener\u00f3w, z poziomu hosta mo\u017cemy zalogowa\u0107 si\u0119 przy pomocy proko\u0142u ssh u\u017cywaj\u0105c nazw DNS (Name) oraz po\u015bwiadcze\u0144 login/password: admin/admin . Przyk\u0142ad dla LEAF-1 [ \ud83d\udc33 +\ud83e\uddea ] marpla@chaos:~/clab$ ssh admin@LEAF-1 # fragmenty ouputu zwi\u0105zane z nawi\u0105zaniem pierwszy raz sesji zosta\u0142y wyci\u0119te dla poprawy czytelno\u015bci Password: LEAF-1> Konfiguracje startowe Ponizej znajduj\u0105 si\u0119 konfiugracje startowe, z kt\u00f3rymi zostan\u0105 uruchomione kontenery cEOS. Konfiguracje do wgl\u0105du dost\u0119pne s\u0105 r\u00f3wniez w postaci repozytorium na GitHub . CLIENT-1 CLIENT-2 LEAF-1 LEAF-2 LEAF-3 LEAF-4-BASE SPINE-1 SPINE-2 hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! interface Port-Channel1 no switchport ip address 172.16.112.201/24 ! interface Port-Channel2 no switchport ip address 172.16.115.100/24 ! interface Ethernet1 channel-group 1 mode active lacp timer fast ! interface Ethernet2 channel-group 1 mode active lacp timer fast ! interface Ethernet3 channel-group 2 mode active lacp timer fast ! interface Ethernet4 channel-group 2 mode active lacp timer fast ! ip route 172.16.116.0/24 172.16.115.1 ip route 172.16.134.0/24 172.16.112.1 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! interface Port-Channel1 no switchport ip address 172.16.112.202/24 ! interface Port-Channel2 no switchport ip address 172.16.116.100/24 ! interface Ethernet1 channel-group 1 mode active ! interface Ethernet2 channel-group 1 mode active ! interface Ethernet3 channel-group 2 mode active ! interface Ethernet4 channel-group 2 mode active ! ! ip route 172.16.115.0/24 172.16.116.1 ip route 172.16.112.0/24 172.16.134.1 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! no spanning-tree vlan-id 4094 ! vlan 12 name CLIENT ! vlan 4094 trunk group MLAGPEER ! interface Port-Channel33 description MLAG - HOST1 switchport mode access switchport access vlan 12 mlag 33 ! interface Port-Channel56 description MLAG PEER LINK - LEAF2 switchport mode trunk switchport trunk group MLAGPEER ! interface Port-Channel12 description MLAG - SPINE1 & 2 switchport mode trunk mlag 12 ! interface Ethernet1 description SPINE1 switchport mode trunk channel-group 12 mode active ! interface Ethernet2 description SPINE2 switchport mode trunk channel-group 12 mode active ! interface Ethernet3 description HOST1 channel-group 33 mode active ! interface Ethernet4 shutdown ! interface Ethernet5 description MLAG PEER LINK - LEAF2 switchport mode trunk channel-group 56 mode active ! interface Ethernet6 description MLAG PEER LINK - LEAF2 switchport mode trunk channel-group 56 mode active ! interface Vlan4094 description MLAG PEER LINK ip address 172.16.12.1/30 ! mlag configuration domain-id MLAG12 local-interface Vlan4094 peer-address 172.16.12.2 peer-link Port-Channel56 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! no spanning-tree vlan-id 4094 ! vlan 12 name CLIENT ! vlan 4094 trunk group MLAGPEER ! interface Port-Channel33 description MLAG - HOST1 switchport mode access switchport access vlan 12 mlag 33 ! interface Port-Channel56 description MLAG PEER LINK - LEAF1 switchport mode trunk switchport trunk group MLAGPEER ! interface Port-Channel12 description MLAG - SPINE1 & 2 switchport mode trunk mlag 12 ! interface Ethernet1 description SPINE1 switchport mode trunk channel-group 12 mode active ! interface Ethernet2 description SPINE2 switchport mode trunk channel-group 12 mode active ! interface Ethernet3 description HOST1 channel-group 33 mode active ! interface Ethernet4 shutdown ! interface Ethernet5 description MLAG PEER LINK - LEAF1 switchport mode trunk channel-group 56 mode active ! interface Ethernet6 description MLAG PEER LINK - LEAF1 switchport mode trunk channel-group 56 mode active ! interface Vlan4094 description MLAG PEER LINK ip address 172.16.12.2/30 ! mlag configuration domain-id MLAG12 local-interface Vlan4094 peer-address 172.16.12.1 peer-link Port-Channel56 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! no spanning-tree vlan-id 4094 ! vlan 12 name CLIENT ! vlan 4094 trunk group MLAGPEER ! interface Port-Channel44 description MLAG - HOST2 switchport mode access switchport access vlan 12 mlag 44 ! interface Port-Channel10 description MLAG PEER LINK - LEAF4 switchport mode trunk switchport trunk group MLAGPEER ! interface Port-Channel34 description MLAG - SPINE1 & 2 switchport mode trunk mlag 34 ! interface Ethernet1 description SPINE1 switchport mode trunk channel-group 34 mode active ! interface Ethernet2 description SPINE2 switchport mode trunk channel-group 34 mode active ! interface Ethernet3 shutdown ! interface Ethernet4 description HOST2 channel-group 44 mode active ! interface Ethernet5 description MLAG PEER LINK - LEAF4 switchport mode trunk channel-group 10 mode active ! interface Ethernet6 description MLAG PEER LINK - LEAF4 switchport mode trunk channel-group 10 mode active ! interface Vlan4094 description MLAG PEER LINK ip address 172.16.34.1/30 ! mlag configuration domain-id MLAG34 local-interface Vlan4094 peer-address 172.16.34.2 peer-link Port-Channel56 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! no spanning-tree vlan-id 4094 ! vlan 4094 trunk group MLAGPEER ! vlan 12 name CLIENT ! interface Port-Channel56 description MLAG PEER LINK - SPINE2 switchport mode trunk switchport trunk group MLAGPEER ! interface Port-Channel12 description MLAG - LEAF1 & 2 switchport mode trunk mlag 12 ! interface Port-Channel34 description MLAG - LEAF3 & 4 switchport mode trunk mlag 34 ! interface Ethernet1 description LEAF1 switchport mode trunk channel-group 12 mode active ! interface Ethernet2 description LEAF2 switchport mode trunk channel-group 12 mode active ! interface Ethernet3 description LEAF3 switchport mode trunk channel-group 34 mode active ! interface Ethernet4 description LEAF4 switchport mode trunk channel-group 34 mode active ! interface Ethernet5 description SPINE2 switchport mode trunk channel-group 56 mode active ! interface Ethernet6 description SPINE2 switchport mode trunk channel-group 56 mode active ! interface Vlan12 ip address 172.16.112.2/24 ip virtual-router address 172.16.112.1 ! ip virtual-router mac-address 00:1c:73:AA:AA:A1 ! interface Vlan4094 description MLAG PEER LINK ip address 172.16.11.1/30 ! mlag configuration domain-id MLAG01 local-interface Vlan4094 peer-address 172.16.11.2 peer-link Port-Channel56 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! no spanning-tree vlan-id 4094 ! vlan 12 name CLIENT ! vlan 4094 trunk group MLAGPEER ! interface Port-Channel56 description MLAG PEER LINK - SPINE1 switchport mode trunk switchport trunk group MLAGPEER ! interface Port-Channel12 description MLAG - LEAF1 & 2 switchport mode trunk mlag 12 ! interface Port-Channel34 description MLAG - LEAF3 & 4 switchport mode trunk mlag 34 ! interface Ethernet1 description LEAF1 switchport mode trunk channel-group 12 mode active ! interface Ethernet2 description LEAF2 switchport mode trunk channel-group 12 mode active ! interface Ethernet3 description LEAF3 switchport mode trunk channel-group 34 mode active ! interface Ethernet4 description LEAF4 switchport mode trunk channel-group 34 mode active ! interface Ethernet5 description SPINE1 switchport mode trunk channel-group 56 mode active ! interface Ethernet6 description SPINE2 switchport mode trunk channel-group 56 mode active ! interface Vlan12 ip address 172.16.112.3/24 ip virtual-router address 172.16.112.1 ! ip virtual-router mac-address 00:1c:73:AA:AA:A1 ! interface Vlan4094 description MLAG PEER LINK ip address 172.16.11.2/30 ! mlag configuration domain-id MLAG01 local-interface Vlan4094 peer-address 172.16.11.1 peer-link Port-Channel56 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end Schemat topologii logicznej MLAG / Port-channel Schemat ukazuje organziacj\u0119 i nazewnictwo skonfigurowanych i brakuj\u0105cych konfiguracji port\u00f3w typu Port-Channel wchodz\u0105cych w sk\u0142ad poszczeg\u00f3lnych MultiChassis LAG'\u00f3w. containerlab-MLAG-physical+PO+MLAG Instrukcja The manually-entered commands below that are part of this lab are equivalent to Leaf4-MLAG-Lab. Log into the LabAccess jumpserver: Type mlag at the prompt. The script will configure the datacenter with the exception of Leaf4. On Leaf3, verify MLAG operation (it should not be operating correctly) show mlag show mlag detail show mlag interfaces Configure MLAG on the Leaf4 switch using the following criteria Configure Port-channel on Leaf4 to used for MLAG communication between Leaf3 & Leaf4. configure interface port-channel 56 description MLAG PEER LINK - LEAF3 switchport mode trunk interface ethernet 5 ,6 description MLAG PEER LINK - LEAF3 channel-group 56 mode active Note A channel-group is a group of interfaces on a single Arista switch. A channel-group is associated with a port-channel interface immediately upon its creation. The channel-group command implicitly creates the matching port-channel with the same ID, which is 56 in this case. The switchport mode trunk command allows all VLANs on port-channel 56. Verify switching operation show interfaces status show lldp neighbors show interfaces trunk show port-channel 56 detailed Tip Each switch is assigned a globally unique sysID by concatenating the 16-bit system priority to a 48-bit MAC address of one of the switch\u2019s physical ports. This sysID is used by peer devices when forming an aggregation to verify that all links are from the same switch - for environments where the MLAG peer link contains multiple physical links - which it does NOT in this example. A trunk group is the set of physical interfaces that comprise the trunk and the collection of VLANs whose traffic is carried on the trunk. The traffic of a VLAN that belongs to one or more trunk groups is carried only on ports that are members of trunk groups to which the VLAN belongs, i.e., VLANs configured in a trunk group are \u2018pruned\u2019 off all ports that are not associated with the trunk group. The spanning-tree protocol (STP) is disabled for the peer-link VLAN 4094 to prevent any potential STP disruption on the interpeer communications link. Since VLAN 4094 has been restricted to only be on the peer-link (Po56) by trunk group MLAGPEER & switchport trunk group MLAGPEER (see step #2.3) the chance of a loop is eliminated. To prevent loops do NOT add this trunk group MLAGPEER to any other interface links. Configure the MLAG VLAN (both Layer 2 and Layer 3). configure vlan 4094 trunk group MLAGPEER interface port-channel 56 switchport trunk group MLAGPEER no spanning-tree vlan-id 4094 interface vlan 4094 description MLAG PEER LINK ip address 172 .16.34.2/30 ping 172 .16.34.1 Warning The ip address 172.16.34.2/30 assigned to one side of the peer-link can be any unicast address that does not conflict with any SVIs on the same switch. The local-interface vlan 4094 command specifies the SVI upon which the switch sends MLAG control traffic. The IP address is specified within the definition of the VLAN associated with this local interface, which you already performed earlier above. While the peer-link\u2019s (designated with the command peer-link port-channel 56 (see below)) primary purpose is to exchange MLAG control information between the 2 peer switches, it also carries dataplane traffic from devices that are attached to only 1 MLAG peer & have no alternative path. This peer-link can also carry traffic in topology failure scenarios (i.e. one of these peer-link switches loses all its uplinks to the spine switches). The domain-id MLAG34 command determines the MLAG domain that consists of these 2 peer switches & the links that connect these 2 switches. The domain-id is case-sensitive and must match the same domain-id on the other peer switch. Define the MLAG Domain. configure mlag domain-id MLAG34 local-interface vlan 4094 peer-address 172 .16.34.1 peer-link port-channel 56 Configure Port-channels and interfaces on Leaf4 connecting to Spine1 & Spine2. configure interface port-channel 34 description MLAG - SPINE1 & 2 switchport mode trunk mlag 34 interface ethernet 1 description SPINE1 channel-group 34 mode active interface ethernet 2 description SPINE2 channel-group 34 mode active Note The mlag 34 (see #2.5) assigns an MLAG ID to interface port-channel 34. MLAG peer switches form an MLAG when each switch configures the same MLAG ID to a port-channel interface. This is different than the MLAG domain-id (see #2.4). The global-scope mlag command above (see #2.4) just enters the global MLAG configuration scope of the Arista switch. Configure Port-channels on Leaf4 connecting to Host2 configure interface port-channel 44 description MLAG - HOST2 switchport access vlan 12 mlag 4 interface ethernet 4 description HOST2 channel-group 44 mode active Validate MLAG on the Leaf4 switch using the following: Verify MLAG operation show mlag show mlag detail show mlag interfaces Verify switching operation show interfaces status show lldp neighbors show interface trunk show port-channel 34 detailed show port-channel 44 detailed show port-channel 56 detailed Validate connectivity from CLIENT-1 to CLIENT-2 by logging into CLIENT-1 through the menu (option 1 in ssh menu) or using screen. ping 172 .16.112.202 LAB COMPLETE! Aby dla prze\u0142\u0105cznik\u00f3w SPINE-1 i SPINE-2 oraz prze\u0142\u0105cznika CLIENT-2 para LEAF-3 i 4 by\u0142y widoczne logicznie jako jedno urz\u0105dzenie \u21a9 u\u017cywaj dok\u0142adnie wskazanej wersji cEOS \u21a9","title":"Lab1 copy"},{"location":"labs/lab1%20copy/#wstep","text":"Celem \u0107wiczenia jest skonfigurowanie interfejs\u00f3w zaagregowanych Po oraz sekcji mlag na prze\u0142\u0105czniku LEAF-4 tworz\u0105cego z prze\u0142\u0105cznikiem LEAF-3 par\u0119 pracuj\u0105c\u0105 w technologii MLAG 1 . Minimalne wymagania sprz\u0119towo do samodzielnego uruchomienia \u015brodowiska: Topologia LAB1-MLAG core Elementy LAB1 6 cEOS & 0 Linux nodes Wymagane zasoby sprz\u0119towe 4vCPU 16 GB Topologia LAB1_MLAG.yaml Dokumentacja Producenta \u00b7 MLAG guide \u00b7 cEOS guide Informacja o wersjach 2 apiusLAB , ceos64-lab:4.27.1.1F","title":"Wst\u0119p"},{"location":"labs/lab1%20copy/#schemat-poaczen-topologia-fizyczna","text":"Topologi\u0119 fizyczn\u0105, organziacj\u0119 po\u0142\u0105cze\u0144 w naszej sieci przedstawia rysunek: containerlab-MLAG-physical","title":"Schemat po\u0142\u0105cze\u0144 / topologia fizyczna"},{"location":"labs/lab1%20copy/#uruchamianie-lab1_mlag-apiuslab","text":"Uruchamiamy nasze laboratorium wybieraj\u0105c z MENU konsoli ApiusLAB \u0107wiczenie: 01 MLAG, a nast\u0119pnie w podmenu ponownie: 01 - uruchom LABa'a. Menu G\u0142owne -> Wybierz LAB'a -> LAB1_MLAG ========== Menu G\u0142owne: Opcje wyboru ========== Wybierz LAB ' a: 01 . MLAG 02 . Leaf & Spine 03 . VxLAN 04 . EVPN VxLAN L2 05 . EVPN VxLAN L3 06 . Telemetria gRPC 88 . Reset 99 . Wyj\u015bcie Co chcia\u0142by\u015b zrobi\u0107? W rezultacie po kilku minutach zostanie uruchomione \u015brodowisko: powo\u0142ane zostan\u0105 kontenery cEOS oraz utworzone po\u0142\u0105czenia sieciowe przy pomocy narz\u0119dzia containerlab zgodnie z zadan\u0105 topologi\u0105 opisan\u0105 deklaratywnie w pliku YAML: LAB1_MLAG.yaml : Stauts LAB'a ' +---+--------------------------+-----------+----------+--------------+---------------------------------+------+---------+-------------------+--------------+ | # | Topo Path | Lab Name | Name | Container ID | Image | Kind | State | IPv4 Address | IPv6 Address | +---+--------------------------+-----------+----------+--------------+---------------------------------+------+---------+-------------------+--------------+ | 1 | LAB1_MLAG/LAB1_MLAG.yaml | LAB1_MLAG | CLIENT-1 | 1832039eabec | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.1/24 | N/A | | 2 | | | CLIENT-2 | 034fa3b9b8b0 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.2/24 | N/A | | 3 | | | LEAF-1 | f8e12dbcd101 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.12/24 | N/A | | 4 | | | LEAF-2 | f125f9195ef5 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.13/24 | N/A | | 5 | | | LEAF-3 | bd17d7473194 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.14/24 | N/A | | 6 | | | LEAF-4 | 7de176deb149 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.15/24 | N/A | | 7 | | | SPINE-1 | 7cc0f23c2897 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.10/24 | N/A | | 8 | | | SPINE-2 | 63077f4f0964 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.11/24 | N/A | +---+--------------------------+-----------+----------+--------------+---------------------------------+------+---------+-------------------+--------------+ W naszym przypadku wygodniejszym sposobem b\u0119dzie skorzytanie z ApiusLAB i wyb\u00f3r opcji: 04 \"Screen do wszystkich router\u00f3w: Menu G\u0142owne -> Wybierz LAB'a -> LAB1_MLAG ========== Menu G\u0142owne -> Wybierz LAB ' a -> LAB1_MLAG ========== 02 . Restartuj LAB 03 . Wy\u0142\u0105cz LAB 04 . Screen do wszystkich router\u00f3w 05 . Shell/Bash 99 . Powr\u00f3t Co chcia\u0142by\u015b zrobi\u0107? W oddzielnych zak\u0142adkach uzyskujemy dost\u0119p do CLI uruchomionych \"urz\u0105dze\u0144\".","title":"Uruchamianie LAB1_MLAG (apiusLAB)"},{"location":"labs/lab1%20copy/#nawigacja-w-screen","text":"Wazniejsze skr\u00f3ty klawiszowe do pracy z screen: ctrl+a n - Przej\u015bcie do nast\u0119pnej zak\u0142adki. ctrl+a p - Przej\u015bcie do poprzedniej zak\u0142adki ctrl+a d - Zamkni\u0119cie wszystkich zak\u0142adek, przej\u015bcie do poprzedniego MENU Info Do ka\u017cdego z kontener\u00f3w, z poziomu hosta mo\u017cemy zalogowa\u0107 si\u0119 przy pomocy proko\u0142u ssh u\u017cywaj\u0105c nazw DNS (Name) oraz po\u015bwiadcze\u0144 login/password: admin/admin . Przyk\u0142ad dla LEAF-1 [ \ud83d\udc33 +\ud83e\uddea ] marpla@chaos:~/clab$ ssh admin@LEAF-1 # fragmenty ouputu zwi\u0105zane z nawi\u0105zaniem pierwszy raz sesji zosta\u0142y wyci\u0119te dla poprawy czytelno\u015bci Password: LEAF-1>","title":"Nawigacja w screen"},{"location":"labs/lab1%20copy/#konfiguracje-startowe","text":"Ponizej znajduj\u0105 si\u0119 konfiugracje startowe, z kt\u00f3rymi zostan\u0105 uruchomione kontenery cEOS. Konfiguracje do wgl\u0105du dost\u0119pne s\u0105 r\u00f3wniez w postaci repozytorium na GitHub . CLIENT-1 CLIENT-2 LEAF-1 LEAF-2 LEAF-3 LEAF-4-BASE SPINE-1 SPINE-2 hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! interface Port-Channel1 no switchport ip address 172.16.112.201/24 ! interface Port-Channel2 no switchport ip address 172.16.115.100/24 ! interface Ethernet1 channel-group 1 mode active lacp timer fast ! interface Ethernet2 channel-group 1 mode active lacp timer fast ! interface Ethernet3 channel-group 2 mode active lacp timer fast ! interface Ethernet4 channel-group 2 mode active lacp timer fast ! ip route 172.16.116.0/24 172.16.115.1 ip route 172.16.134.0/24 172.16.112.1 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! interface Port-Channel1 no switchport ip address 172.16.112.202/24 ! interface Port-Channel2 no switchport ip address 172.16.116.100/24 ! interface Ethernet1 channel-group 1 mode active ! interface Ethernet2 channel-group 1 mode active ! interface Ethernet3 channel-group 2 mode active ! interface Ethernet4 channel-group 2 mode active ! ! ip route 172.16.115.0/24 172.16.116.1 ip route 172.16.112.0/24 172.16.134.1 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! no spanning-tree vlan-id 4094 ! vlan 12 name CLIENT ! vlan 4094 trunk group MLAGPEER ! interface Port-Channel33 description MLAG - HOST1 switchport mode access switchport access vlan 12 mlag 33 ! interface Port-Channel56 description MLAG PEER LINK - LEAF2 switchport mode trunk switchport trunk group MLAGPEER ! interface Port-Channel12 description MLAG - SPINE1 & 2 switchport mode trunk mlag 12 ! interface Ethernet1 description SPINE1 switchport mode trunk channel-group 12 mode active ! interface Ethernet2 description SPINE2 switchport mode trunk channel-group 12 mode active ! interface Ethernet3 description HOST1 channel-group 33 mode active ! interface Ethernet4 shutdown ! interface Ethernet5 description MLAG PEER LINK - LEAF2 switchport mode trunk channel-group 56 mode active ! interface Ethernet6 description MLAG PEER LINK - LEAF2 switchport mode trunk channel-group 56 mode active ! interface Vlan4094 description MLAG PEER LINK ip address 172.16.12.1/30 ! mlag configuration domain-id MLAG12 local-interface Vlan4094 peer-address 172.16.12.2 peer-link Port-Channel56 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! no spanning-tree vlan-id 4094 ! vlan 12 name CLIENT ! vlan 4094 trunk group MLAGPEER ! interface Port-Channel33 description MLAG - HOST1 switchport mode access switchport access vlan 12 mlag 33 ! interface Port-Channel56 description MLAG PEER LINK - LEAF1 switchport mode trunk switchport trunk group MLAGPEER ! interface Port-Channel12 description MLAG - SPINE1 & 2 switchport mode trunk mlag 12 ! interface Ethernet1 description SPINE1 switchport mode trunk channel-group 12 mode active ! interface Ethernet2 description SPINE2 switchport mode trunk channel-group 12 mode active ! interface Ethernet3 description HOST1 channel-group 33 mode active ! interface Ethernet4 shutdown ! interface Ethernet5 description MLAG PEER LINK - LEAF1 switchport mode trunk channel-group 56 mode active ! interface Ethernet6 description MLAG PEER LINK - LEAF1 switchport mode trunk channel-group 56 mode active ! interface Vlan4094 description MLAG PEER LINK ip address 172.16.12.2/30 ! mlag configuration domain-id MLAG12 local-interface Vlan4094 peer-address 172.16.12.1 peer-link Port-Channel56 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! no spanning-tree vlan-id 4094 ! vlan 12 name CLIENT ! vlan 4094 trunk group MLAGPEER ! interface Port-Channel44 description MLAG - HOST2 switchport mode access switchport access vlan 12 mlag 44 ! interface Port-Channel10 description MLAG PEER LINK - LEAF4 switchport mode trunk switchport trunk group MLAGPEER ! interface Port-Channel34 description MLAG - SPINE1 & 2 switchport mode trunk mlag 34 ! interface Ethernet1 description SPINE1 switchport mode trunk channel-group 34 mode active ! interface Ethernet2 description SPINE2 switchport mode trunk channel-group 34 mode active ! interface Ethernet3 shutdown ! interface Ethernet4 description HOST2 channel-group 44 mode active ! interface Ethernet5 description MLAG PEER LINK - LEAF4 switchport mode trunk channel-group 10 mode active ! interface Ethernet6 description MLAG PEER LINK - LEAF4 switchport mode trunk channel-group 10 mode active ! interface Vlan4094 description MLAG PEER LINK ip address 172.16.34.1/30 ! mlag configuration domain-id MLAG34 local-interface Vlan4094 peer-address 172.16.34.2 peer-link Port-Channel56 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! no spanning-tree vlan-id 4094 ! vlan 4094 trunk group MLAGPEER ! vlan 12 name CLIENT ! interface Port-Channel56 description MLAG PEER LINK - SPINE2 switchport mode trunk switchport trunk group MLAGPEER ! interface Port-Channel12 description MLAG - LEAF1 & 2 switchport mode trunk mlag 12 ! interface Port-Channel34 description MLAG - LEAF3 & 4 switchport mode trunk mlag 34 ! interface Ethernet1 description LEAF1 switchport mode trunk channel-group 12 mode active ! interface Ethernet2 description LEAF2 switchport mode trunk channel-group 12 mode active ! interface Ethernet3 description LEAF3 switchport mode trunk channel-group 34 mode active ! interface Ethernet4 description LEAF4 switchport mode trunk channel-group 34 mode active ! interface Ethernet5 description SPINE2 switchport mode trunk channel-group 56 mode active ! interface Ethernet6 description SPINE2 switchport mode trunk channel-group 56 mode active ! interface Vlan12 ip address 172.16.112.2/24 ip virtual-router address 172.16.112.1 ! ip virtual-router mac-address 00:1c:73:AA:AA:A1 ! interface Vlan4094 description MLAG PEER LINK ip address 172.16.11.1/30 ! mlag configuration domain-id MLAG01 local-interface Vlan4094 peer-address 172.16.11.2 peer-link Port-Channel56 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! no spanning-tree vlan-id 4094 ! vlan 12 name CLIENT ! vlan 4094 trunk group MLAGPEER ! interface Port-Channel56 description MLAG PEER LINK - SPINE1 switchport mode trunk switchport trunk group MLAGPEER ! interface Port-Channel12 description MLAG - LEAF1 & 2 switchport mode trunk mlag 12 ! interface Port-Channel34 description MLAG - LEAF3 & 4 switchport mode trunk mlag 34 ! interface Ethernet1 description LEAF1 switchport mode trunk channel-group 12 mode active ! interface Ethernet2 description LEAF2 switchport mode trunk channel-group 12 mode active ! interface Ethernet3 description LEAF3 switchport mode trunk channel-group 34 mode active ! interface Ethernet4 description LEAF4 switchport mode trunk channel-group 34 mode active ! interface Ethernet5 description SPINE1 switchport mode trunk channel-group 56 mode active ! interface Ethernet6 description SPINE2 switchport mode trunk channel-group 56 mode active ! interface Vlan12 ip address 172.16.112.3/24 ip virtual-router address 172.16.112.1 ! ip virtual-router mac-address 00:1c:73:AA:AA:A1 ! interface Vlan4094 description MLAG PEER LINK ip address 172.16.11.2/30 ! mlag configuration domain-id MLAG01 local-interface Vlan4094 peer-address 172.16.11.1 peer-link Port-Channel56 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end","title":"Konfiguracje startowe"},{"location":"labs/lab1%20copy/#schemat-topologii-logicznej-mlag-port-channel","text":"Schemat ukazuje organziacj\u0119 i nazewnictwo skonfigurowanych i brakuj\u0105cych konfiguracji port\u00f3w typu Port-Channel wchodz\u0105cych w sk\u0142ad poszczeg\u00f3lnych MultiChassis LAG'\u00f3w. containerlab-MLAG-physical+PO+MLAG","title":"Schemat topologii logicznej MLAG / Port-channel"},{"location":"labs/lab1%20copy/#instrukcja","text":"The manually-entered commands below that are part of this lab are equivalent to Leaf4-MLAG-Lab. Log into the LabAccess jumpserver: Type mlag at the prompt. The script will configure the datacenter with the exception of Leaf4. On Leaf3, verify MLAG operation (it should not be operating correctly) show mlag show mlag detail show mlag interfaces Configure MLAG on the Leaf4 switch using the following criteria","title":"Instrukcja"},{"location":"labs/lab1%20copy/#configure-port-channel-on-leaf4-to-used-for-mlag-communication-between-leaf3-leaf4","text":"configure interface port-channel 56 description MLAG PEER LINK - LEAF3 switchport mode trunk interface ethernet 5 ,6 description MLAG PEER LINK - LEAF3 channel-group 56 mode active Note A channel-group is a group of interfaces on a single Arista switch. A channel-group is associated with a port-channel interface immediately upon its creation. The channel-group command implicitly creates the matching port-channel with the same ID, which is 56 in this case. The switchport mode trunk command allows all VLANs on port-channel 56.","title":"Configure Port-channel on Leaf4 to used for MLAG communication between Leaf3 &amp; Leaf4."},{"location":"labs/lab1%20copy/#verify-switching-operation","text":"show interfaces status show lldp neighbors show interfaces trunk show port-channel 56 detailed Tip Each switch is assigned a globally unique sysID by concatenating the 16-bit system priority to a 48-bit MAC address of one of the switch\u2019s physical ports. This sysID is used by peer devices when forming an aggregation to verify that all links are from the same switch - for environments where the MLAG peer link contains multiple physical links - which it does NOT in this example. A trunk group is the set of physical interfaces that comprise the trunk and the collection of VLANs whose traffic is carried on the trunk. The traffic of a VLAN that belongs to one or more trunk groups is carried only on ports that are members of trunk groups to which the VLAN belongs, i.e., VLANs configured in a trunk group are \u2018pruned\u2019 off all ports that are not associated with the trunk group. The spanning-tree protocol (STP) is disabled for the peer-link VLAN 4094 to prevent any potential STP disruption on the interpeer communications link. Since VLAN 4094 has been restricted to only be on the peer-link (Po56) by trunk group MLAGPEER & switchport trunk group MLAGPEER (see step #2.3) the chance of a loop is eliminated. To prevent loops do NOT add this trunk group MLAGPEER to any other interface links. Configure the MLAG VLAN (both Layer 2 and Layer 3). configure vlan 4094 trunk group MLAGPEER interface port-channel 56 switchport trunk group MLAGPEER no spanning-tree vlan-id 4094 interface vlan 4094 description MLAG PEER LINK ip address 172 .16.34.2/30 ping 172 .16.34.1 Warning The ip address 172.16.34.2/30 assigned to one side of the peer-link can be any unicast address that does not conflict with any SVIs on the same switch. The local-interface vlan 4094 command specifies the SVI upon which the switch sends MLAG control traffic. The IP address is specified within the definition of the VLAN associated with this local interface, which you already performed earlier above. While the peer-link\u2019s (designated with the command peer-link port-channel 56 (see below)) primary purpose is to exchange MLAG control information between the 2 peer switches, it also carries dataplane traffic from devices that are attached to only 1 MLAG peer & have no alternative path. This peer-link can also carry traffic in topology failure scenarios (i.e. one of these peer-link switches loses all its uplinks to the spine switches). The domain-id MLAG34 command determines the MLAG domain that consists of these 2 peer switches & the links that connect these 2 switches. The domain-id is case-sensitive and must match the same domain-id on the other peer switch.","title":"Verify switching operation"},{"location":"labs/lab1%20copy/#define-the-mlag-domain","text":"configure mlag domain-id MLAG34 local-interface vlan 4094 peer-address 172 .16.34.1 peer-link port-channel 56 Configure Port-channels and interfaces on Leaf4 connecting to Spine1 & Spine2. configure interface port-channel 34 description MLAG - SPINE1 & 2 switchport mode trunk mlag 34 interface ethernet 1 description SPINE1 channel-group 34 mode active interface ethernet 2 description SPINE2 channel-group 34 mode active Note The mlag 34 (see #2.5) assigns an MLAG ID to interface port-channel 34. MLAG peer switches form an MLAG when each switch configures the same MLAG ID to a port-channel interface. This is different than the MLAG domain-id (see #2.4). The global-scope mlag command above (see #2.4) just enters the global MLAG configuration scope of the Arista switch. Configure Port-channels on Leaf4 connecting to Host2 configure interface port-channel 44 description MLAG - HOST2 switchport access vlan 12 mlag 4 interface ethernet 4 description HOST2 channel-group 44 mode active Validate MLAG on the Leaf4 switch using the following: Verify MLAG operation show mlag show mlag detail show mlag interfaces Verify switching operation show interfaces status show lldp neighbors show interface trunk show port-channel 34 detailed show port-channel 44 detailed show port-channel 56 detailed Validate connectivity from CLIENT-1 to CLIENT-2 by logging into CLIENT-1 through the menu (option 1 in ssh menu) or using screen. ping 172 .16.112.202","title":"Define the MLAG Domain."},{"location":"labs/lab1%20copy/#lab-complete","text":"Aby dla prze\u0142\u0105cznik\u00f3w SPINE-1 i SPINE-2 oraz prze\u0142\u0105cznika CLIENT-2 para LEAF-3 i 4 by\u0142y widoczne logicznie jako jedno urz\u0105dzenie \u21a9 u\u017cywaj dok\u0142adnie wskazanej wersji cEOS \u21a9","title":"LAB COMPLETE!"},{"location":"labs/lab1/","text":"Wst\u0119p Celem \u0107wiczenia jest skonfigurowanie interfejs\u00f3w zaagregowanych Po oraz sekcji mlag na prze\u0142\u0105czniku LEAF-4 tworz\u0105cego z prze\u0142\u0105cznikiem LEAF-3 par\u0119 pracuj\u0105c\u0105 w technologii MLAG 1 . Minimalne wymagania sprz\u0119towo do samodzielnego uruchomienia \u015brodowiska: Elementy LAB1 6 cEOS & 0 Linux nodes Wymagane zasoby sprz\u0119towe 4vCPU 16 GB Topologia LAB1_MLAG.yaml Dokumentacja Producenta \u00b7 MLAG guide \u00b7 cEOS guide Informacja o wersjach 2 apiusLAB , ceos64-lab:4.27.1.1F Schemat po\u0142\u0105cze\u0144 / topologia fizyczna Topologi\u0119 fizyczn\u0105, organziacj\u0119 po\u0142\u0105cze\u0144 w naszej sieci przedstawia rysunek: containerlab-MLAG-physical Start Menu apiusLAB Po skonfigurowaniu i uruchomieniu \u015brodowiska apiusLAB (VM + docker + github repo: LAB1_MLAG + kontenery: cEOS oraz apius lab), uruchamiamy nasze laboratorium wybieraj\u0105c z MENU konsoli ApiusLAB \u0107wiczenie: 01 MLAG, a nast\u0119pnie w podmenu ponownie: 01 - uruchom LABa'a. Menu G\u0142owne -> Wybierz LAB'a -> LAB1_MLAG ========== Menu G\u0142owne: Opcje wyboru ========== Wybierz LAB ' a: 01 . MLAG 02 . Leaf & Spine 03 . VxLAN 04 . EVPN VxLAN L2 05 . EVPN VxLAN L3 06 . Telemetria gRPC 88 . Reset 99 . Wyj\u015bcie Co chcia\u0142by\u015b zrobi\u0107? W rezultacie po kilku minutach zostanie uruchomione \u015brodowisko: powo\u0142ane zostan\u0105 kontenery cEOS oraz utworzone po\u0142\u0105czenia sieciowe przy pomocy narz\u0119dzia containerlab zgodnie z zadan\u0105 topologi\u0105 opisan\u0105 deklaratywnie w pliku YAML: LAB1_MLAG.yaml : Stauts LAB'a ' +---+--------------------------+-----------+----------+--------------+---------------------------------+------+---------+-------------------+--------------+ | # | Topo Path | Lab Name | Name | Container ID | Image | Kind | State | IPv4 Address | IPv6 Address | +---+--------------------------+-----------+----------+--------------+---------------------------------+------+---------+-------------------+--------------+ | 1 | LAB1_MLAG/LAB1_MLAG.yaml | LAB1_MLAG | CLIENT-1 | 1832039eabec | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.1/24 | N/A | | 2 | | | CLIENT-2 | 034fa3b9b8b0 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.2/24 | N/A | | 3 | | | LEAF-1 | f8e12dbcd101 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.12/24 | N/A | | 4 | | | LEAF-2 | f125f9195ef5 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.13/24 | N/A | | 5 | | | LEAF-3 | bd17d7473194 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.14/24 | N/A | | 6 | | | LEAF-4 | 7de176deb149 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.15/24 | N/A | | 7 | | | SPINE-1 | 7cc0f23c2897 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.10/24 | N/A | | 8 | | | SPINE-2 | 63077f4f0964 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.11/24 | N/A | +---+--------------------------+-----------+----------+--------------+---------------------------------+------+---------+-------------------+--------------+ W naszym przypadku wygodniejszym sposobem b\u0119dzie skorzytanie z ApiusLAB i wyb\u00f3r opcji: 04 \"Screen do wszystkich router\u00f3w: Menu G\u0142owne -> Wybierz LAB'a -> LAB1_MLAG ========== Menu G\u0142owne -> Wybierz LAB ' a -> LAB1_MLAG ========== 02 . Restartuj LAB 03 . Wy\u0142\u0105cz LAB 04 . Screen do wszystkich router\u00f3w 05 . Shell/Bash 99 . Powr\u00f3t Co chcia\u0142by\u015b zrobi\u0107? W oddzielnych zak\u0142adkach uzyskujemy dost\u0119p do CLI uruchomionych \"urz\u0105dze\u0144\". screen - nawigacja Wazniejsze skr\u00f3ty klawiszowe do pracy z screen: ctrl+a n - Przej\u015bcie do nast\u0119pnej zak\u0142adki. ctrl+a p - Przej\u015bcie do poprzedniej zak\u0142adki ctrl+a d - Zamkni\u0119cie wszystkich zak\u0142adek, przej\u015bcie do poprzedniego MENU Info Do ka\u017cdego z kontener\u00f3w, z poziomu hosta mo\u017cemy zalogowa\u0107 si\u0119 przy pomocy proko\u0142u ssh u\u017cywaj\u0105c nazw DNS (Name) oraz po\u015bwiadcze\u0144 login/password: admin/admin . Przyk\u0142ad dla LEAF-1 [ \ud83d\udc33 +\ud83e\uddea ] marpla@chaos:~/clab$ ssh admin@LEAF-1 # fragmenty ouputu zwi\u0105zane z nawi\u0105zaniem pierwszy raz sesji zosta\u0142y wyci\u0119te dla poprawy czytelno\u015bci Password: LEAF-1> Konfiguracje startowe Ponizej znajduj\u0105 si\u0119 konfiugracje startowe, z kt\u00f3rymi zostan\u0105 uruchomione kontenery cEOS. Konfiguracje do wgl\u0105du dost\u0119pne s\u0105 r\u00f3wniez w postaci repozytorium na GitHub . CLIENT-1 CLIENT-2 LEAF-1 LEAF-2 LEAF-3 LEAF-4-BASE SPINE-1 SPINE-2 hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! interface Port-Channel1 no switchport ip address 172.16.112.201/24 ! interface Port-Channel2 no switchport ip address 172.16.115.100/24 ! interface Ethernet1 channel-group 1 mode active lacp timer fast ! interface Ethernet2 channel-group 1 mode active lacp timer fast ! interface Ethernet3 channel-group 2 mode active lacp timer fast ! interface Ethernet4 channel-group 2 mode active lacp timer fast ! ip route 172.16.116.0/24 172.16.115.1 ip route 172.16.134.0/24 172.16.112.1 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! interface Port-Channel1 no switchport ip address 172.16.112.202/24 ! interface Port-Channel2 no switchport ip address 172.16.116.100/24 ! interface Ethernet1 channel-group 1 mode active ! interface Ethernet2 channel-group 1 mode active ! interface Ethernet3 channel-group 2 mode active ! interface Ethernet4 channel-group 2 mode active ! ! ip route 172.16.115.0/24 172.16.116.1 ip route 172.16.112.0/24 172.16.134.1 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! no spanning-tree vlan-id 4094 ! vlan 12 name CLIENT ! vlan 4094 trunk group MLAGPEER ! interface Port-Channel33 description MLAG - HOST1 switchport mode access switchport access vlan 12 mlag 33 ! interface Port-Channel56 description MLAG PEER LINK - LEAF2 switchport mode trunk switchport trunk group MLAGPEER ! interface Port-Channel12 description MLAG - SPINE1 & 2 switchport mode trunk mlag 12 ! interface Ethernet1 description SPINE1 switchport mode trunk channel-group 12 mode active ! interface Ethernet2 description SPINE2 switchport mode trunk channel-group 12 mode active ! interface Ethernet3 description HOST1 channel-group 33 mode active ! interface Ethernet4 shutdown ! interface Ethernet5 description MLAG PEER LINK - LEAF2 switchport mode trunk channel-group 56 mode active ! interface Ethernet6 description MLAG PEER LINK - LEAF2 switchport mode trunk channel-group 56 mode active ! interface Vlan4094 description MLAG PEER LINK ip address 172.16.12.1/30 ! mlag configuration domain-id MLAG12 local-interface Vlan4094 peer-address 172.16.12.2 peer-link Port-Channel56 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! no spanning-tree vlan-id 4094 ! vlan 12 name CLIENT ! vlan 4094 trunk group MLAGPEER ! interface Port-Channel33 description MLAG - HOST1 switchport mode access switchport access vlan 12 mlag 33 ! interface Port-Channel56 description MLAG PEER LINK - LEAF1 switchport mode trunk switchport trunk group MLAGPEER ! interface Port-Channel12 description MLAG - SPINE1 & 2 switchport mode trunk mlag 12 ! interface Ethernet1 description SPINE1 switchport mode trunk channel-group 12 mode active ! interface Ethernet2 description SPINE2 switchport mode trunk channel-group 12 mode active ! interface Ethernet3 description HOST1 channel-group 33 mode active ! interface Ethernet4 shutdown ! interface Ethernet5 description MLAG PEER LINK - LEAF1 switchport mode trunk channel-group 56 mode active ! interface Ethernet6 description MLAG PEER LINK - LEAF1 switchport mode trunk channel-group 56 mode active ! interface Vlan4094 description MLAG PEER LINK ip address 172.16.12.2/30 ! mlag configuration domain-id MLAG12 local-interface Vlan4094 peer-address 172.16.12.1 peer-link Port-Channel56 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! no spanning-tree vlan-id 4094 ! vlan 12 name CLIENT ! vlan 4094 trunk group MLAGPEER ! interface Port-Channel44 description MLAG - HOST2 switchport mode access switchport access vlan 12 mlag 44 ! interface Port-Channel10 description MLAG PEER LINK - LEAF4 switchport mode trunk switchport trunk group MLAGPEER ! interface Port-Channel34 description MLAG - SPINE1 & 2 switchport mode trunk mlag 34 ! interface Ethernet1 description SPINE1 switchport mode trunk channel-group 34 mode active ! interface Ethernet2 description SPINE2 switchport mode trunk channel-group 34 mode active ! interface Ethernet3 shutdown ! interface Ethernet4 description HOST2 channel-group 44 mode active ! interface Ethernet5 description MLAG PEER LINK - LEAF4 switchport mode trunk channel-group 10 mode active ! interface Ethernet6 description MLAG PEER LINK - LEAF4 switchport mode trunk channel-group 10 mode active ! interface Vlan4094 description MLAG PEER LINK ip address 172.16.34.1/30 ! mlag configuration domain-id MLAG34 local-interface Vlan4094 peer-address 172.16.34.2 peer-link Port-Channel56 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! no spanning-tree vlan-id 4094 ! vlan 4094 trunk group MLAGPEER ! vlan 12 name CLIENT ! interface Port-Channel56 description MLAG PEER LINK - SPINE2 switchport mode trunk switchport trunk group MLAGPEER ! interface Port-Channel12 description MLAG - LEAF1 & 2 switchport mode trunk mlag 12 ! interface Port-Channel34 description MLAG - LEAF3 & 4 switchport mode trunk mlag 34 ! interface Ethernet1 description LEAF1 switchport mode trunk channel-group 12 mode active ! interface Ethernet2 description LEAF2 switchport mode trunk channel-group 12 mode active ! interface Ethernet3 description LEAF3 switchport mode trunk channel-group 34 mode active ! interface Ethernet4 description LEAF4 switchport mode trunk channel-group 34 mode active ! interface Ethernet5 description SPINE2 switchport mode trunk channel-group 56 mode active ! interface Ethernet6 description SPINE2 switchport mode trunk channel-group 56 mode active ! interface Vlan12 ip address 172.16.112.2/24 ip virtual-router address 172.16.112.1 ! ip virtual-router mac-address 00:1c:73:AA:AA:A1 ! interface Vlan4094 description MLAG PEER LINK ip address 172.16.11.1/30 ! mlag configuration domain-id MLAG01 local-interface Vlan4094 peer-address 172.16.11.2 peer-link Port-Channel56 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! no spanning-tree vlan-id 4094 ! vlan 12 name CLIENT ! vlan 4094 trunk group MLAGPEER ! interface Port-Channel56 description MLAG PEER LINK - SPINE1 switchport mode trunk switchport trunk group MLAGPEER ! interface Port-Channel12 description MLAG - LEAF1 & 2 switchport mode trunk mlag 12 ! interface Port-Channel34 description MLAG - LEAF3 & 4 switchport mode trunk mlag 34 ! interface Ethernet1 description LEAF1 switchport mode trunk channel-group 12 mode active ! interface Ethernet2 description LEAF2 switchport mode trunk channel-group 12 mode active ! interface Ethernet3 description LEAF3 switchport mode trunk channel-group 34 mode active ! interface Ethernet4 description LEAF4 switchport mode trunk channel-group 34 mode active ! interface Ethernet5 description SPINE1 switchport mode trunk channel-group 56 mode active ! interface Ethernet6 description SPINE2 switchport mode trunk channel-group 56 mode active ! interface Vlan12 ip address 172.16.112.3/24 ip virtual-router address 172.16.112.1 ! ip virtual-router mac-address 00:1c:73:AA:AA:A1 ! interface Vlan4094 description MLAG PEER LINK ip address 172.16.11.2/30 ! mlag configuration domain-id MLAG01 local-interface Vlan4094 peer-address 172.16.11.1 peer-link Port-Channel56 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end Schemat topologii logicznej MLAG / Port-channel Schemat ukazuje organziacj\u0119 i nazewnictwo skonfigurowanych i brakuj\u0105cych konfiguracji port\u00f3w typu Port-Channel wchodz\u0105cych w sk\u0142ad poszczeg\u00f3lnych MultiChassis LAG'\u00f3w. containerlab-MLAG-physical+PO+MLAG Krok po Kroku Skonfiguruj MLAG na LEAF-4 wed\u0142ug ponizszych wskaz\u00f3wek 1. Weryfikacja stanu pocz\u0105tkowego Zweryfikuj pocz\u0105tkowy stan urz\u0105dze\u0144. Por\u00f3wnaj konfiguracj\u0119 MLAG i Port-Channel na LEAF1 i 2 oraz drugiej parze LEAF-3 i 4. Wykorzystaj komendy: show mlag show mlag detail show mlag interfaces show port-channel Tip Zobacz jakie opcje oferuje komenda show port-channel: LEAF-4#show port-channel ? active-ports Display info on ports that are active members of the LAG all-ports Display info on all ports configured for LAG, even those not currently active brief Display all port-channel status briefly dense Display summary of port-channel status detailed Display detailed port-channel status limits Display limits on port-channel membership load-balance Display traffic distribution of port-channel members $ list end < 1 -999999> Channel Group ID ( s ) > Redirect output to URL >> Append redirected output to URL | Command output pipe filters 2. Port-channel Peer Link pomi\u0119dzy Leaf-3 i Leaf-4 (dataplane) Skonfigurguj Port-channel56 na LEAF-4 do komunikacji pomi\u0119dzy Leaf-3 & 4: configure interface port-channel 56 description MLAG PEER LINK - LEAF3 switchport mode trunk dodawanie port\u00f3w fizycznych et5 i et6 do interfejsu logicznego Po56: configure interface ethernet 5 ,6 description MLAG PEER LINK - LEAF3 channel-group 56 mode active Note channel-group to grupa interfejs\u00f3w na pojedynczym prze\u0142\u0105czniku Arista. Interejsy dopisane do channel-group zostaj\u0105 powi\u0105zana z interfejsem port-channel natychmiast po jej utworzeniu. Polecenie grupy kana\u0142\u00f3w niejawnie tworzy pasuj\u0105cy kana\u0142 portu o tym samym identyfikatorze, kt\u00f3ry w tym przypadku wynosi 56. Polecenie \u0142\u0105cza trunk w trybie switchport zezwala na wszystkie sieci VLAN na kanale portu 56. 3. Weryfikacja dzia\u0142ania Peer-Link show interfaces status show lldp neighbors show interfaces trunk show port-channel 56 detailed Tip Ka\u017cdemu prze\u0142\u0105cznikowi przypisywany jest globalnie unikalny identyfikator sysID przez po\u0142\u0105czenie 16-bitowego identyfikatora: priority system z 48-bitowym adresem MAC jednego z port\u00f3w fizycznych prze\u0142\u0105cznika. Identyfikator sysID jest u\u017cywany przez urz\u0105dzenia podczas tworzenia interfejsu agregregowanego w celu sprawdzenia, czy wszystkie \u0142\u0105cza pochodz\u0105 z tego samego prze\u0142\u0105cznika. 4. Konfiguracja MLAG VLAN (Layer 2 and Layer 3). W naszym przyk\u0142adzie konfigurujemy trunk grup\u0119 MLAGPEER w vlanie 4094. Dodatkowo wy\u0142\u0105czamy protok\u00f3\u0142 spannig-tree protocol (STP) dla VLAN4094 i tym samym \u0142\u0105cza peer-link (Po56), aby zapobiec potencjalnym zak\u0142\u00f3ceniom pochodz\u0105cym z niestabilno\u015bci STP. Poniewa\u017c obecno\u015b\u0107 VLAN 4094 zosta\u0142a ograniczona tylko do peerlinku (Po56) i trunk grup\u0119 MLAGPEER, szansa na wyst\u0105pienie p\u0119tli jest praktycznie wyeliminowana. Aby zapobiec p\u0119tlom, NIE dodawaj tej trunk grupy (MLAGPEER) do \u017cadnych innych interfejs\u00f3w. Note Abstrakt trunk-group to obiekt - zestaw, na kt\u00f3ry sk\u0142adaj\u0105 si\u0119 interfejsy typu trunk'a i listy sieci VLAN. Ruch w danym VLANie nale\u017c\u0105cym do jednej lub wi\u0119cej trunk group jest przenoszony tylko na portach, kt\u00f3re s\u0105 cz\u0142onkami grupy i do kt\u00f3rych nale\u017cy dany VLAN. Inaczej m\u00f3wi\u0105c VLANy skonfigurowane w ramach trunk group s\u0105 \u201epruned off\u201d ze wszystkich port\u00f3w, kt\u00f3re nie s\u0105 skojarzone z t\u0105 trunk-group. configure vlan 4094 trunk group MLAGPEER interface port-channel 56 switchport trunk group MLAGPEER no spanning-tree vlan-id 4094 Dodatkowo na potrzeby warstwy Control-Plane konfigurujemy adresacj\u0119 IP dla interfejsy SVI (SubInterface VLAN) interface vlan 4094 description MLAG PEER LINK ip address 172 .16.34.2/30 Przetestuj odpowiedz z LEAF-3 ping 172 .16.34.1 Warning Adrescja P2P 172.16.34.0/30 moze by\u0107 dowoln\u0105 adresacj\u0105 unicast, kt\u00f3ra nie konfliktuje z pozosta\u0142\u0105 adresacj\u0105 na urz\u0105dzeniu. Adresacja peerlink ma znaczenie lokalne, dla kazdej pary MLAG moze to byc dowolna adresacja IP unicast. Interfejs SVI warstwy L3 dla VLAN4094 zapewnia wymian\u0119 komunikacji warstwy kontrolnej MLAG pomi\u0119dzy par\u0105 prze\u0142\u0105cznik\u00f3w. Peer-link przenosi takze ruch typu data (data-plane) w przypadku awarii, kt\u00f3rego\u015b\u0107 z uplink\u00f3w do prze\u0142\u0105cznik\u00f3w SPINE. 5. Zdefiniuj domen\u0119 MLAG Natomiast identyfikator domain-id MLAG34 determinuje jednoznacznie domen\u0119 - par\u0119 prze\u0142\u0105cznik\u00f3w MLAG. Domain-id jest parametrem case-sensitive i musi by\u0107 dok\u0142adnie taki sam na obu urz\u0105dzeniach. configure mlag domain-id MLAG34 local-interface vlan 4094 peer-address 172 .16.34.1 peer-link port-channel 56 6. Skonfiguruj interfejsy Port-channel i interfejsy fizyczne uplink do SPINE-1 i 2 Konfigurujemy zatem interfjes Po34. Zwr\u00f3c uwag\u0119, i do konfiguracji interfejsu Port-channel koniecznie musimy doda\u0107 komend\u0119 mlag 34 identyfikuj\u0105c\u0105 rozproszony interfejs zagregowany MLAG. configure interface port-channel 34 description MLAG - SPINE1 & 2 switchport mode trunk mlag 34 interface ethernet 1 description SPINE1 channel-group 34 mode active interface ethernet 2 description SPINE2 channel-group 34 mode active Note Poleceniem mlag 34 przypisujemy MLAG ID do interfejsu port-channel 34. Prze\u0142\u0105czniki (MLAG Peers) sformuj\u0105 interfejs logiczny, rozproszony, zagregowany Port-channel - MultiChassis LAG (MLAG)) posiadaj\u0105cych oczywi\u015bcie ten sam domain-id, gdy wskazemy ten sam identyfikator MLAG ID do kazdego interfejsu port-channel. MLAG ID ma zasi\u0119g globalny per konfiguracja prze\u0142\u0105cznika, dla kazdego intefejsu MLAG musi by\u0107 unikalny. 7. Skonfiguruj interfejs Port-channel i interfejsy fizyczne uplink do CLIENT-2 Dla przyk\u0142adu identygikator MLAG ID przyjmuje tutaj warto\u015b\u0107 4. konfigurujemy Port-channel 44 w tyrbie access (port dost\u0119powy) o VLAN ID 12. configure interface port-channel 44 description MLAG - HOST2 switchport access vlan 12 mlag 4 Korzystaj\u0105c z dostarczonego diagramu lub weryfikuj\u0105c, gdzie fizycznie mamy pod\u0142\u0105czonego CLIENT'a-2: LEAF-4>show lldp neighbors Last table change time : 13 :29:37 ago Number of table inserts : 13 Number of table deletes : 1 Number of table drops : 0 Number of table age-outs : 1 Port Neighbor Device ID Neighbor Port ID TTL ---------- ------------------------ ---------------------- --- Et1 SPINE-1 Ethernet4 120 Et2 SPINE-2 Ethernet4 120 Et4 CLIENT-2 Ethernet2 120 Et5 LEAF-3 Ethernet5 120 Et6 LEAF-3 Ethernet6 120 i finalnie konfigurujemy port et4: interface ethernet 4 description HOST2 channel-group 44 mode active 8. Weryfikujemy konfiguracj\u0119 LEAF-4 Weryfikujemy wprowadzon\u0105 konfiguracj\u0119 uzywaj\u0105c ponizszych komend. show mlag show mlag detail show mlag interfaces Weryfikujemy po\u0142\u0105czenia show interfaces status show lldp neighbors show interface trunk show port-channel 34 detailed <- uplink do SPINE-1 i 2 show port-channel 44 detailed <- downlink do CLIENT-2 show port-channel 56 detailed <- interlink PeerLink pomi\u0119dzy LEAF3 i 4 finalnie spradzamy \u0142aczno\u015b\u0107 pomi\u0119dzy CLIENT-1 do CLIENT-2 polecniem ping b\u0105d\u017a ssh: CLIENT-1>ping ip 172 .16.112.202 PING 172 .16.112.202 ( 172 .16.112.202 ) 72 ( 100 ) bytes of data. 80 bytes from 172 .16.112.202: icmp_seq = 1 ttl = 64 time = 128 ms 80 bytes from 172 .16.112.202: icmp_seq = 2 ttl = 64 time = 131 ms 80 bytes from 172 .16.112.202: icmp_seq = 3 ttl = 64 time = 161 ms 80 bytes from 172 .16.112.202: icmp_seq = 4 ttl = 64 time = 156 ms 80 bytes from 172 .16.112.202: icmp_seq = 5 ttl = 64 time = 177 ms --- 172 .16.112.202 ping statistics --- 5 packets transmitted, 5 received, 0 % packet loss, time 42ms rtt min/avg/max/mdev = 128 .001/151.127/177.659/18.701 ms, pipe 5 , ipg/ewma 10 .734/140.866 ms CLIENT-1> CLIENT-1>ssh -l admin 172 .16.112.202 Warning: Permanently added '172.16.112.202' ( ECDSA ) to the list of known hosts. Password: CLIENT-2> LAB UKO\u0143CZONY! Finalnie logiczna infrastruktura prezentuje si\u0119 jak na rysunku: Aby dla prze\u0142\u0105cznik\u00f3w SPINE-1 i SPINE-2 oraz prze\u0142\u0105cznika CLIENT-2 para LEAF-3 i 4 by\u0142y widoczne logicznie jako jedno urz\u0105dzenie \u21a9 u\u017cywaj dok\u0142adnie wskazanej wersji cEOS \u21a9","title":"LAB 1 (MLAG)"},{"location":"labs/lab1/#wstep","text":"Celem \u0107wiczenia jest skonfigurowanie interfejs\u00f3w zaagregowanych Po oraz sekcji mlag na prze\u0142\u0105czniku LEAF-4 tworz\u0105cego z prze\u0142\u0105cznikiem LEAF-3 par\u0119 pracuj\u0105c\u0105 w technologii MLAG 1 .","title":"Wst\u0119p"},{"location":"labs/lab1/#minimalne-wymagania-sprzetowo-do-samodzielnego-uruchomienia-srodowiska","text":"Elementy LAB1 6 cEOS & 0 Linux nodes Wymagane zasoby sprz\u0119towe 4vCPU 16 GB Topologia LAB1_MLAG.yaml Dokumentacja Producenta \u00b7 MLAG guide \u00b7 cEOS guide Informacja o wersjach 2 apiusLAB , ceos64-lab:4.27.1.1F","title":"Minimalne wymagania sprz\u0119towo do samodzielnego uruchomienia \u015brodowiska:"},{"location":"labs/lab1/#schemat-poaczen-topologia-fizyczna","text":"Topologi\u0119 fizyczn\u0105, organziacj\u0119 po\u0142\u0105cze\u0144 w naszej sieci przedstawia rysunek: containerlab-MLAG-physical","title":"Schemat po\u0142\u0105cze\u0144 / topologia fizyczna"},{"location":"labs/lab1/#start","text":"","title":"Start"},{"location":"labs/lab1/#menu-apiuslab","text":"Po skonfigurowaniu i uruchomieniu \u015brodowiska apiusLAB (VM + docker + github repo: LAB1_MLAG + kontenery: cEOS oraz apius lab), uruchamiamy nasze laboratorium wybieraj\u0105c z MENU konsoli ApiusLAB \u0107wiczenie: 01 MLAG, a nast\u0119pnie w podmenu ponownie: 01 - uruchom LABa'a. Menu G\u0142owne -> Wybierz LAB'a -> LAB1_MLAG ========== Menu G\u0142owne: Opcje wyboru ========== Wybierz LAB ' a: 01 . MLAG 02 . Leaf & Spine 03 . VxLAN 04 . EVPN VxLAN L2 05 . EVPN VxLAN L3 06 . Telemetria gRPC 88 . Reset 99 . Wyj\u015bcie Co chcia\u0142by\u015b zrobi\u0107? W rezultacie po kilku minutach zostanie uruchomione \u015brodowisko: powo\u0142ane zostan\u0105 kontenery cEOS oraz utworzone po\u0142\u0105czenia sieciowe przy pomocy narz\u0119dzia containerlab zgodnie z zadan\u0105 topologi\u0105 opisan\u0105 deklaratywnie w pliku YAML: LAB1_MLAG.yaml : Stauts LAB'a ' +---+--------------------------+-----------+----------+--------------+---------------------------------+------+---------+-------------------+--------------+ | # | Topo Path | Lab Name | Name | Container ID | Image | Kind | State | IPv4 Address | IPv6 Address | +---+--------------------------+-----------+----------+--------------+---------------------------------+------+---------+-------------------+--------------+ | 1 | LAB1_MLAG/LAB1_MLAG.yaml | LAB1_MLAG | CLIENT-1 | 1832039eabec | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.1/24 | N/A | | 2 | | | CLIENT-2 | 034fa3b9b8b0 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.2/24 | N/A | | 3 | | | LEAF-1 | f8e12dbcd101 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.12/24 | N/A | | 4 | | | LEAF-2 | f125f9195ef5 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.13/24 | N/A | | 5 | | | LEAF-3 | bd17d7473194 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.14/24 | N/A | | 6 | | | LEAF-4 | 7de176deb149 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.15/24 | N/A | | 7 | | | SPINE-1 | 7cc0f23c2897 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.10/24 | N/A | | 8 | | | SPINE-2 | 63077f4f0964 | marekplaza/ceos64-lab:4.27.1.1F | ceos | running | 172 .100.100.11/24 | N/A | +---+--------------------------+-----------+----------+--------------+---------------------------------+------+---------+-------------------+--------------+ W naszym przypadku wygodniejszym sposobem b\u0119dzie skorzytanie z ApiusLAB i wyb\u00f3r opcji: 04 \"Screen do wszystkich router\u00f3w: Menu G\u0142owne -> Wybierz LAB'a -> LAB1_MLAG ========== Menu G\u0142owne -> Wybierz LAB ' a -> LAB1_MLAG ========== 02 . Restartuj LAB 03 . Wy\u0142\u0105cz LAB 04 . Screen do wszystkich router\u00f3w 05 . Shell/Bash 99 . Powr\u00f3t Co chcia\u0142by\u015b zrobi\u0107? W oddzielnych zak\u0142adkach uzyskujemy dost\u0119p do CLI uruchomionych \"urz\u0105dze\u0144\".","title":"Menu apiusLAB"},{"location":"labs/lab1/#screen-nawigacja","text":"Wazniejsze skr\u00f3ty klawiszowe do pracy z screen: ctrl+a n - Przej\u015bcie do nast\u0119pnej zak\u0142adki. ctrl+a p - Przej\u015bcie do poprzedniej zak\u0142adki ctrl+a d - Zamkni\u0119cie wszystkich zak\u0142adek, przej\u015bcie do poprzedniego MENU Info Do ka\u017cdego z kontener\u00f3w, z poziomu hosta mo\u017cemy zalogowa\u0107 si\u0119 przy pomocy proko\u0142u ssh u\u017cywaj\u0105c nazw DNS (Name) oraz po\u015bwiadcze\u0144 login/password: admin/admin . Przyk\u0142ad dla LEAF-1 [ \ud83d\udc33 +\ud83e\uddea ] marpla@chaos:~/clab$ ssh admin@LEAF-1 # fragmenty ouputu zwi\u0105zane z nawi\u0105zaniem pierwszy raz sesji zosta\u0142y wyci\u0119te dla poprawy czytelno\u015bci Password: LEAF-1>","title":"screen - nawigacja"},{"location":"labs/lab1/#konfiguracje-startowe","text":"Ponizej znajduj\u0105 si\u0119 konfiugracje startowe, z kt\u00f3rymi zostan\u0105 uruchomione kontenery cEOS. Konfiguracje do wgl\u0105du dost\u0119pne s\u0105 r\u00f3wniez w postaci repozytorium na GitHub . CLIENT-1 CLIENT-2 LEAF-1 LEAF-2 LEAF-3 LEAF-4-BASE SPINE-1 SPINE-2 hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! interface Port-Channel1 no switchport ip address 172.16.112.201/24 ! interface Port-Channel2 no switchport ip address 172.16.115.100/24 ! interface Ethernet1 channel-group 1 mode active lacp timer fast ! interface Ethernet2 channel-group 1 mode active lacp timer fast ! interface Ethernet3 channel-group 2 mode active lacp timer fast ! interface Ethernet4 channel-group 2 mode active lacp timer fast ! ip route 172.16.116.0/24 172.16.115.1 ip route 172.16.134.0/24 172.16.112.1 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! interface Port-Channel1 no switchport ip address 172.16.112.202/24 ! interface Port-Channel2 no switchport ip address 172.16.116.100/24 ! interface Ethernet1 channel-group 1 mode active ! interface Ethernet2 channel-group 1 mode active ! interface Ethernet3 channel-group 2 mode active ! interface Ethernet4 channel-group 2 mode active ! ! ip route 172.16.115.0/24 172.16.116.1 ip route 172.16.112.0/24 172.16.134.1 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! no spanning-tree vlan-id 4094 ! vlan 12 name CLIENT ! vlan 4094 trunk group MLAGPEER ! interface Port-Channel33 description MLAG - HOST1 switchport mode access switchport access vlan 12 mlag 33 ! interface Port-Channel56 description MLAG PEER LINK - LEAF2 switchport mode trunk switchport trunk group MLAGPEER ! interface Port-Channel12 description MLAG - SPINE1 & 2 switchport mode trunk mlag 12 ! interface Ethernet1 description SPINE1 switchport mode trunk channel-group 12 mode active ! interface Ethernet2 description SPINE2 switchport mode trunk channel-group 12 mode active ! interface Ethernet3 description HOST1 channel-group 33 mode active ! interface Ethernet4 shutdown ! interface Ethernet5 description MLAG PEER LINK - LEAF2 switchport mode trunk channel-group 56 mode active ! interface Ethernet6 description MLAG PEER LINK - LEAF2 switchport mode trunk channel-group 56 mode active ! interface Vlan4094 description MLAG PEER LINK ip address 172.16.12.1/30 ! mlag configuration domain-id MLAG12 local-interface Vlan4094 peer-address 172.16.12.2 peer-link Port-Channel56 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! no spanning-tree vlan-id 4094 ! vlan 12 name CLIENT ! vlan 4094 trunk group MLAGPEER ! interface Port-Channel33 description MLAG - HOST1 switchport mode access switchport access vlan 12 mlag 33 ! interface Port-Channel56 description MLAG PEER LINK - LEAF1 switchport mode trunk switchport trunk group MLAGPEER ! interface Port-Channel12 description MLAG - SPINE1 & 2 switchport mode trunk mlag 12 ! interface Ethernet1 description SPINE1 switchport mode trunk channel-group 12 mode active ! interface Ethernet2 description SPINE2 switchport mode trunk channel-group 12 mode active ! interface Ethernet3 description HOST1 channel-group 33 mode active ! interface Ethernet4 shutdown ! interface Ethernet5 description MLAG PEER LINK - LEAF1 switchport mode trunk channel-group 56 mode active ! interface Ethernet6 description MLAG PEER LINK - LEAF1 switchport mode trunk channel-group 56 mode active ! interface Vlan4094 description MLAG PEER LINK ip address 172.16.12.2/30 ! mlag configuration domain-id MLAG12 local-interface Vlan4094 peer-address 172.16.12.1 peer-link Port-Channel56 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! no spanning-tree vlan-id 4094 ! vlan 12 name CLIENT ! vlan 4094 trunk group MLAGPEER ! interface Port-Channel44 description MLAG - HOST2 switchport mode access switchport access vlan 12 mlag 44 ! interface Port-Channel10 description MLAG PEER LINK - LEAF4 switchport mode trunk switchport trunk group MLAGPEER ! interface Port-Channel34 description MLAG - SPINE1 & 2 switchport mode trunk mlag 34 ! interface Ethernet1 description SPINE1 switchport mode trunk channel-group 34 mode active ! interface Ethernet2 description SPINE2 switchport mode trunk channel-group 34 mode active ! interface Ethernet3 shutdown ! interface Ethernet4 description HOST2 channel-group 44 mode active ! interface Ethernet5 description MLAG PEER LINK - LEAF4 switchport mode trunk channel-group 10 mode active ! interface Ethernet6 description MLAG PEER LINK - LEAF4 switchport mode trunk channel-group 10 mode active ! interface Vlan4094 description MLAG PEER LINK ip address 172.16.34.1/30 ! mlag configuration domain-id MLAG34 local-interface Vlan4094 peer-address 172.16.34.2 peer-link Port-Channel56 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! no spanning-tree vlan-id 4094 ! vlan 4094 trunk group MLAGPEER ! vlan 12 name CLIENT ! interface Port-Channel56 description MLAG PEER LINK - SPINE2 switchport mode trunk switchport trunk group MLAGPEER ! interface Port-Channel12 description MLAG - LEAF1 & 2 switchport mode trunk mlag 12 ! interface Port-Channel34 description MLAG - LEAF3 & 4 switchport mode trunk mlag 34 ! interface Ethernet1 description LEAF1 switchport mode trunk channel-group 12 mode active ! interface Ethernet2 description LEAF2 switchport mode trunk channel-group 12 mode active ! interface Ethernet3 description LEAF3 switchport mode trunk channel-group 34 mode active ! interface Ethernet4 description LEAF4 switchport mode trunk channel-group 34 mode active ! interface Ethernet5 description SPINE2 switchport mode trunk channel-group 56 mode active ! interface Ethernet6 description SPINE2 switchport mode trunk channel-group 56 mode active ! interface Vlan12 ip address 172.16.112.2/24 ip virtual-router address 172.16.112.1 ! ip virtual-router mac-address 00:1c:73:AA:AA:A1 ! interface Vlan4094 description MLAG PEER LINK ip address 172.16.11.1/30 ! mlag configuration domain-id MLAG01 local-interface Vlan4094 peer-address 172.16.11.2 peer-link Port-Channel56 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end hostname {{ .ShortName }} ! no aaa root ! username admin privilege 15 secret admin username cvpadmin privilege 15 role network-admin secret sha512 $6$IvmYcGkpLFv.DZXu$JKI11Ocs0gqsnm.jXGU.XRU3I.NasSQVVzywH0Vk1HLfLFamFL6nwKjcDPzpqgALj13CDBUFIY7HL2OYvRhOa1 ! service routing protocols model multi-agent ! interface Management0 vrf mgmt {{ if .MgmtIPv4Address }}ip address {{ .MgmtIPv4Address }}/{{.MgmtIPv4PrefixLength}}{{end}} {{ if .MgmtIPv6Address }}ipv6 address {{ .MgmtIPv6Address }}/{{.MgmtIPv6PrefixLength}}{{end}} no lldp transmit no lldp receive ! no spanning-tree vlan-id 4094 ! vlan 12 name CLIENT ! vlan 4094 trunk group MLAGPEER ! interface Port-Channel56 description MLAG PEER LINK - SPINE1 switchport mode trunk switchport trunk group MLAGPEER ! interface Port-Channel12 description MLAG - LEAF1 & 2 switchport mode trunk mlag 12 ! interface Port-Channel34 description MLAG - LEAF3 & 4 switchport mode trunk mlag 34 ! interface Ethernet1 description LEAF1 switchport mode trunk channel-group 12 mode active ! interface Ethernet2 description LEAF2 switchport mode trunk channel-group 12 mode active ! interface Ethernet3 description LEAF3 switchport mode trunk channel-group 34 mode active ! interface Ethernet4 description LEAF4 switchport mode trunk channel-group 34 mode active ! interface Ethernet5 description SPINE1 switchport mode trunk channel-group 56 mode active ! interface Ethernet6 description SPINE2 switchport mode trunk channel-group 56 mode active ! interface Vlan12 ip address 172.16.112.3/24 ip virtual-router address 172.16.112.1 ! ip virtual-router mac-address 00:1c:73:AA:AA:A1 ! interface Vlan4094 description MLAG PEER LINK ip address 172.16.11.2/30 ! mlag configuration domain-id MLAG01 local-interface Vlan4094 peer-address 172.16.11.1 peer-link Port-Channel56 ! vrf instance mgmt ! ip routing ! ip routing vrf mgmt ! management api gnmi transport grpc default vrf mgmt ! management api netconf transport ssh default vrf mgmt ! management api http-commands protocol http protocol unix-socket no shutdown ! vrf mgmt no shutdown ! ip name-server vrf mgmt 8.8.8.8 ! ntp server vrf mgmt tempus1.gum.gov.pl iburst ! ip route vrf mgmt 0.0.0.0/0 172.100.100.250 end","title":"Konfiguracje startowe"},{"location":"labs/lab1/#schemat-topologii-logicznej-mlag-port-channel","text":"Schemat ukazuje organziacj\u0119 i nazewnictwo skonfigurowanych i brakuj\u0105cych konfiguracji port\u00f3w typu Port-Channel wchodz\u0105cych w sk\u0142ad poszczeg\u00f3lnych MultiChassis LAG'\u00f3w. containerlab-MLAG-physical+PO+MLAG","title":"Schemat topologii logicznej MLAG / Port-channel"},{"location":"labs/lab1/#krok-po-kroku","text":"Skonfiguruj MLAG na LEAF-4 wed\u0142ug ponizszych wskaz\u00f3wek","title":"Krok po Kroku"},{"location":"labs/lab1/#1-weryfikacja-stanu-poczatkowego","text":"Zweryfikuj pocz\u0105tkowy stan urz\u0105dze\u0144. Por\u00f3wnaj konfiguracj\u0119 MLAG i Port-Channel na LEAF1 i 2 oraz drugiej parze LEAF-3 i 4. Wykorzystaj komendy: show mlag show mlag detail show mlag interfaces show port-channel Tip Zobacz jakie opcje oferuje komenda show port-channel: LEAF-4#show port-channel ? active-ports Display info on ports that are active members of the LAG all-ports Display info on all ports configured for LAG, even those not currently active brief Display all port-channel status briefly dense Display summary of port-channel status detailed Display detailed port-channel status limits Display limits on port-channel membership load-balance Display traffic distribution of port-channel members $ list end < 1 -999999> Channel Group ID ( s ) > Redirect output to URL >> Append redirected output to URL | Command output pipe filters","title":"1. Weryfikacja stanu pocz\u0105tkowego"},{"location":"labs/lab1/#2-port-channel-peer-link-pomiedzy-leaf-3-i-leaf-4-dataplane","text":"Skonfigurguj Port-channel56 na LEAF-4 do komunikacji pomi\u0119dzy Leaf-3 & 4: configure interface port-channel 56 description MLAG PEER LINK - LEAF3 switchport mode trunk dodawanie port\u00f3w fizycznych et5 i et6 do interfejsu logicznego Po56: configure interface ethernet 5 ,6 description MLAG PEER LINK - LEAF3 channel-group 56 mode active Note channel-group to grupa interfejs\u00f3w na pojedynczym prze\u0142\u0105czniku Arista. Interejsy dopisane do channel-group zostaj\u0105 powi\u0105zana z interfejsem port-channel natychmiast po jej utworzeniu. Polecenie grupy kana\u0142\u00f3w niejawnie tworzy pasuj\u0105cy kana\u0142 portu o tym samym identyfikatorze, kt\u00f3ry w tym przypadku wynosi 56. Polecenie \u0142\u0105cza trunk w trybie switchport zezwala na wszystkie sieci VLAN na kanale portu 56.","title":"2. Port-channel Peer Link pomi\u0119dzy Leaf-3 i Leaf-4 (dataplane)"},{"location":"labs/lab1/#3-weryfikacja-dziaania-peer-link","text":"show interfaces status show lldp neighbors show interfaces trunk show port-channel 56 detailed Tip Ka\u017cdemu prze\u0142\u0105cznikowi przypisywany jest globalnie unikalny identyfikator sysID przez po\u0142\u0105czenie 16-bitowego identyfikatora: priority system z 48-bitowym adresem MAC jednego z port\u00f3w fizycznych prze\u0142\u0105cznika. Identyfikator sysID jest u\u017cywany przez urz\u0105dzenia podczas tworzenia interfejsu agregregowanego w celu sprawdzenia, czy wszystkie \u0142\u0105cza pochodz\u0105 z tego samego prze\u0142\u0105cznika.","title":"3. Weryfikacja dzia\u0142ania Peer-Link"},{"location":"labs/lab1/#4-konfiguracja-mlag-vlan-layer-2-and-layer-3","text":"W naszym przyk\u0142adzie konfigurujemy trunk grup\u0119 MLAGPEER w vlanie 4094. Dodatkowo wy\u0142\u0105czamy protok\u00f3\u0142 spannig-tree protocol (STP) dla VLAN4094 i tym samym \u0142\u0105cza peer-link (Po56), aby zapobiec potencjalnym zak\u0142\u00f3ceniom pochodz\u0105cym z niestabilno\u015bci STP. Poniewa\u017c obecno\u015b\u0107 VLAN 4094 zosta\u0142a ograniczona tylko do peerlinku (Po56) i trunk grup\u0119 MLAGPEER, szansa na wyst\u0105pienie p\u0119tli jest praktycznie wyeliminowana. Aby zapobiec p\u0119tlom, NIE dodawaj tej trunk grupy (MLAGPEER) do \u017cadnych innych interfejs\u00f3w. Note Abstrakt trunk-group to obiekt - zestaw, na kt\u00f3ry sk\u0142adaj\u0105 si\u0119 interfejsy typu trunk'a i listy sieci VLAN. Ruch w danym VLANie nale\u017c\u0105cym do jednej lub wi\u0119cej trunk group jest przenoszony tylko na portach, kt\u00f3re s\u0105 cz\u0142onkami grupy i do kt\u00f3rych nale\u017cy dany VLAN. Inaczej m\u00f3wi\u0105c VLANy skonfigurowane w ramach trunk group s\u0105 \u201epruned off\u201d ze wszystkich port\u00f3w, kt\u00f3re nie s\u0105 skojarzone z t\u0105 trunk-group. configure vlan 4094 trunk group MLAGPEER interface port-channel 56 switchport trunk group MLAGPEER no spanning-tree vlan-id 4094 Dodatkowo na potrzeby warstwy Control-Plane konfigurujemy adresacj\u0119 IP dla interfejsy SVI (SubInterface VLAN) interface vlan 4094 description MLAG PEER LINK ip address 172 .16.34.2/30 Przetestuj odpowiedz z LEAF-3 ping 172 .16.34.1 Warning Adrescja P2P 172.16.34.0/30 moze by\u0107 dowoln\u0105 adresacj\u0105 unicast, kt\u00f3ra nie konfliktuje z pozosta\u0142\u0105 adresacj\u0105 na urz\u0105dzeniu. Adresacja peerlink ma znaczenie lokalne, dla kazdej pary MLAG moze to byc dowolna adresacja IP unicast. Interfejs SVI warstwy L3 dla VLAN4094 zapewnia wymian\u0119 komunikacji warstwy kontrolnej MLAG pomi\u0119dzy par\u0105 prze\u0142\u0105cznik\u00f3w. Peer-link przenosi takze ruch typu data (data-plane) w przypadku awarii, kt\u00f3rego\u015b\u0107 z uplink\u00f3w do prze\u0142\u0105cznik\u00f3w SPINE.","title":"4. Konfiguracja MLAG VLAN (Layer 2 and Layer 3)."},{"location":"labs/lab1/#5-zdefiniuj-domene-mlag","text":"Natomiast identyfikator domain-id MLAG34 determinuje jednoznacznie domen\u0119 - par\u0119 prze\u0142\u0105cznik\u00f3w MLAG. Domain-id jest parametrem case-sensitive i musi by\u0107 dok\u0142adnie taki sam na obu urz\u0105dzeniach. configure mlag domain-id MLAG34 local-interface vlan 4094 peer-address 172 .16.34.1 peer-link port-channel 56","title":"5. Zdefiniuj domen\u0119 MLAG"},{"location":"labs/lab1/#6-skonfiguruj-interfejsy-port-channel-i-interfejsy-fizyczne-uplink-do-spine-1-i-2","text":"Konfigurujemy zatem interfjes Po34. Zwr\u00f3c uwag\u0119, i do konfiguracji interfejsu Port-channel koniecznie musimy doda\u0107 komend\u0119 mlag 34 identyfikuj\u0105c\u0105 rozproszony interfejs zagregowany MLAG. configure interface port-channel 34 description MLAG - SPINE1 & 2 switchport mode trunk mlag 34 interface ethernet 1 description SPINE1 channel-group 34 mode active interface ethernet 2 description SPINE2 channel-group 34 mode active Note Poleceniem mlag 34 przypisujemy MLAG ID do interfejsu port-channel 34. Prze\u0142\u0105czniki (MLAG Peers) sformuj\u0105 interfejs logiczny, rozproszony, zagregowany Port-channel - MultiChassis LAG (MLAG)) posiadaj\u0105cych oczywi\u015bcie ten sam domain-id, gdy wskazemy ten sam identyfikator MLAG ID do kazdego interfejsu port-channel. MLAG ID ma zasi\u0119g globalny per konfiguracja prze\u0142\u0105cznika, dla kazdego intefejsu MLAG musi by\u0107 unikalny.","title":"6. Skonfiguruj interfejsy Port-channel i interfejsy fizyczne uplink do SPINE-1 i 2"},{"location":"labs/lab1/#7-skonfiguruj-interfejs-port-channel-i-interfejsy-fizyczne-uplink-do-client-2","text":"Dla przyk\u0142adu identygikator MLAG ID przyjmuje tutaj warto\u015b\u0107 4. konfigurujemy Port-channel 44 w tyrbie access (port dost\u0119powy) o VLAN ID 12. configure interface port-channel 44 description MLAG - HOST2 switchport access vlan 12 mlag 4 Korzystaj\u0105c z dostarczonego diagramu lub weryfikuj\u0105c, gdzie fizycznie mamy pod\u0142\u0105czonego CLIENT'a-2: LEAF-4>show lldp neighbors Last table change time : 13 :29:37 ago Number of table inserts : 13 Number of table deletes : 1 Number of table drops : 0 Number of table age-outs : 1 Port Neighbor Device ID Neighbor Port ID TTL ---------- ------------------------ ---------------------- --- Et1 SPINE-1 Ethernet4 120 Et2 SPINE-2 Ethernet4 120 Et4 CLIENT-2 Ethernet2 120 Et5 LEAF-3 Ethernet5 120 Et6 LEAF-3 Ethernet6 120 i finalnie konfigurujemy port et4: interface ethernet 4 description HOST2 channel-group 44 mode active","title":"7. Skonfiguruj interfejs Port-channel i interfejsy fizyczne uplink do CLIENT-2"},{"location":"labs/lab1/#8-weryfikujemy-konfiguracje-leaf-4","text":"Weryfikujemy wprowadzon\u0105 konfiguracj\u0119 uzywaj\u0105c ponizszych komend. show mlag show mlag detail show mlag interfaces Weryfikujemy po\u0142\u0105czenia show interfaces status show lldp neighbors show interface trunk show port-channel 34 detailed <- uplink do SPINE-1 i 2 show port-channel 44 detailed <- downlink do CLIENT-2 show port-channel 56 detailed <- interlink PeerLink pomi\u0119dzy LEAF3 i 4 finalnie spradzamy \u0142aczno\u015b\u0107 pomi\u0119dzy CLIENT-1 do CLIENT-2 polecniem ping b\u0105d\u017a ssh: CLIENT-1>ping ip 172 .16.112.202 PING 172 .16.112.202 ( 172 .16.112.202 ) 72 ( 100 ) bytes of data. 80 bytes from 172 .16.112.202: icmp_seq = 1 ttl = 64 time = 128 ms 80 bytes from 172 .16.112.202: icmp_seq = 2 ttl = 64 time = 131 ms 80 bytes from 172 .16.112.202: icmp_seq = 3 ttl = 64 time = 161 ms 80 bytes from 172 .16.112.202: icmp_seq = 4 ttl = 64 time = 156 ms 80 bytes from 172 .16.112.202: icmp_seq = 5 ttl = 64 time = 177 ms --- 172 .16.112.202 ping statistics --- 5 packets transmitted, 5 received, 0 % packet loss, time 42ms rtt min/avg/max/mdev = 128 .001/151.127/177.659/18.701 ms, pipe 5 , ipg/ewma 10 .734/140.866 ms CLIENT-1> CLIENT-1>ssh -l admin 172 .16.112.202 Warning: Permanently added '172.16.112.202' ( ECDSA ) to the list of known hosts. Password: CLIENT-2>","title":"8. Weryfikujemy konfiguracj\u0119 LEAF-4"},{"location":"labs/lab1/#lab-ukonczony","text":"Finalnie logiczna infrastruktura prezentuje si\u0119 jak na rysunku: Aby dla prze\u0142\u0105cznik\u00f3w SPINE-1 i SPINE-2 oraz prze\u0142\u0105cznika CLIENT-2 para LEAF-3 i 4 by\u0142y widoczne logicznie jako jedno urz\u0105dzenie \u21a9 u\u017cywaj dok\u0142adnie wskazanej wersji cEOS \u21a9","title":"LAB UKO\u0143CZONY!"},{"location":"labs/lab2/","text":"Warning w przygotowaniu, zapraszamy wkr\u00f3tce","title":"LAB 8 (CI/CD)"},{"location":"labs/lab3/","text":"Warning w przygotowaniu, zapraszamy wkr\u00f3tce","title":"Lab3"}]}